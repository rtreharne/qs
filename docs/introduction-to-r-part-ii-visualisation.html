<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Introduction to R part II: Visualisation | Quantiative Skills in Biosciences I</title>
  <meta name="description" content="5 Introduction to R part II: Visualisation | Quantiative Skills in Biosciences I" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Introduction to R part II: Visualisation | Quantiative Skills in Biosciences I" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Introduction to R part II: Visualisation | Quantiative Skills in Biosciences I" />
  
  
  

<meta name="author" content="R. E. Treharne" />


<meta name="date" content="2024-10-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-r-part-i.html"/>
<link rel="next" href="appendix.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Cover</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to Excel and R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#estimating-the-volume-of-a-snail"><i class="fa fa-check"></i><b>1.1</b> Estimating the Volume of a Snail</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#download-and-import-the-csv-file"><i class="fa fa-check"></i><b>1.1.1</b> Download and Import the CSV File</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#calculate-volume-v-in-excel"><i class="fa fa-check"></i><b>1.1.2</b> Calculate Volume <span class="math inline">\(V\)</span> in Excel</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#add-a-linear-trendline-and-equation"><i class="fa fa-check"></i><b>1.1.3</b> Add a Linear Trendline and Equation</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#estimation-of-volume-for-a-snail-with-mass-10g"><i class="fa fa-check"></i><b>1.1.4</b> Estimation of Volume for a Snail with Mass 10g</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#getting-ready-for-R"><i class="fa fa-check"></i><b>1.2</b> Getting Ready for R</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#download-and-install-windows-and-mac-only"><i class="fa fa-check"></i><b>1.2.1</b> Download and Install (Windows and Mac only)</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#creating-your-first-r-project-in-rstudio"><i class="fa fa-check"></i><b>1.2.2</b> Creating Your First R Project in RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#something-more-complicated"><i class="fa fa-check"></i><b>1.2.3</b> Something More Complicated</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#complete-your-weekly-assignments"><i class="fa fa-check"></i><b>1.3</b> Complete your Weekly Assignments</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html"><i class="fa fa-check"></i><b>2</b> Summarising Data and ANOVA in Excel</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#summarising-data"><i class="fa fa-check"></i><b>2.1</b> Summarising Data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#download-and-import-the-csv-file-1"><i class="fa fa-check"></i><b>2.1.1</b> Download and Import the CSV File</a></li>
<li class="chapter" data-level="2.1.2" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#generating-a-summary-table"><i class="fa fa-check"></i><b>2.1.2</b> Generating a Summary Table</a></li>
<li class="chapter" data-level="2.1.3" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#presenting-your-summary-table"><i class="fa fa-check"></i><b>2.1.3</b> Presenting Your Summary Table</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>2.2</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#grouped-boxplots-in-excel"><i class="fa fa-check"></i><b>2.2.1</b> Grouped Boxplots in Excel</a></li>
<li class="chapter" data-level="2.2.2" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#constructing-testable-hypotheses"><i class="fa fa-check"></i><b>2.2.2</b> Constructing Testable Hypotheses</a></li>
<li class="chapter" data-level="2.2.3" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#performing-a-one-way-anova-in-excel"><i class="fa fa-check"></i><b>2.2.3</b> Performing a One-Way Anova in Excel</a></li>
<li class="chapter" data-level="2.2.4" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#performing-post-hoc-tests-in-excel"><i class="fa fa-check"></i><b>2.2.4</b> Performing Post-hoc Tests in Excel</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#complete-your-weekly-assignments-1"><i class="fa fa-check"></i><b>2.3</b> Complete your Weekly Assignments</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html"><i class="fa fa-check"></i><b>3</b> Calibration Curves and Linear Regression in Excel</a>
<ul>
<li class="chapter" data-level="3.1" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#calibration-curves"><i class="fa fa-check"></i><b>3.1</b> Calibration Curves</a></li>
<li class="chapter" data-level="3.2" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#linear-regression"><i class="fa fa-check"></i><b>3.2</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#the-linear-regression-equation"><i class="fa fa-check"></i><b>3.2.1</b> The Linear Regression Equation</a></li>
<li class="chapter" data-level="3.2.2" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#performing-a-linear-regression-in-excel"><i class="fa fa-check"></i><b>3.2.2</b> Performing a Linear Regression in Excel</a></li>
<li class="chapter" data-level="3.2.3" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#interpreting-your-linear-regression"><i class="fa fa-check"></i><b>3.2.3</b> Interpreting Your Linear Regression</a></li>
<li class="chapter" data-level="3.2.4" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#making-predictions-with-our-model"><i class="fa fa-check"></i><b>3.2.4</b> Making Predictions with Our Model</a></li>
<li class="chapter" data-level="3.2.5" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#extending-to-multiple-variables"><i class="fa fa-check"></i><b>3.2.5</b> Extending to Multiple Variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#complete-your-weekly-assignments-2"><i class="fa fa-check"></i><b>3.3</b> Complete your Weekly Assignments</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html"><i class="fa fa-check"></i><b>4</b> Introduction to R: Part I</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#reading-and-inspecting-data"><i class="fa fa-check"></i><b>4.1</b> Reading and Inspecting Data</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#subsetting"><i class="fa fa-check"></i><b>4.2</b> Subsetting</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#slicing"><i class="fa fa-check"></i><b>4.2.1</b> Slicing</a></li>
<li class="chapter" data-level="4.2.2" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#filtering"><i class="fa fa-check"></i><b>4.2.2</b> Filtering</a></li>
<li class="chapter" data-level="4.2.3" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#so-what"><i class="fa fa-check"></i><b>4.2.3</b> So what?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#summarising-data-in-r"><i class="fa fa-check"></i><b>4.3</b> Summarising Data in R</a></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#complete-your-weekly-assignments-3"><i class="fa fa-check"></i><b>4.4</b> Complete your Weekly Assignments</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html"><i class="fa fa-check"></i><b>5</b> Introduction to R part II: Visualisation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#mushroom-compost-scenario"><i class="fa fa-check"></i><b>5.1</b> Mushroom Compost Scenario</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#the-dataset"><i class="fa fa-check"></i><b>5.1.1</b> The dataset</a></li>
<li class="chapter" data-level="5.1.2" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#further-information"><i class="fa fa-check"></i><b>5.1.2</b> Further information</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#inspecting-and-summarising"><i class="fa fa-check"></i><b>5.2</b> Inspecting and Summarising</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#summary-table"><i class="fa fa-check"></i><b>5.2.1</b> Summary Table</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#histogram"><i class="fa fa-check"></i><b>5.3</b> Histogram</a></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#grouped-boxplot"><i class="fa fa-check"></i><b>5.4</b> Grouped Boxplot</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#scatterplot"><i class="fa fa-check"></i><b>5.5</b> Scatterplot</a></li>
<li class="chapter" data-level="5.6" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#just-for-fun"><i class="fa fa-check"></i><b>5.6</b> Just for Fun</a></li>
<li class="chapter" data-level="5.7" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#complete-your-weekly-assignments-4"><i class="fa fa-check"></i><b>5.7</b> Complete your Weekly Assignments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix: Teach yourself R.</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#linkedin-learning"><i class="fa fa-check"></i>LinkedIn Learning</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#youtube"><i class="fa fa-check"></i>YouTube</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#books"><i class="fa fa-check"></i>Books</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantiative Skills in Biosciences I</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-r-part-ii-visualisation" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Introduction to R part II: Visualisation<a href="introduction-to-r-part-ii-visualisation.html#introduction-to-r-part-ii-visualisation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>If you are currently participating in a timetabled BIOS103 QS workshop, please ensure that you cover <strong>all of this section’s content</strong> and complete this week’s <strong>summative assessment</strong> in the BIOS103 Canvas Course. There is no formative assessment this week.</p>
<p>Our brains are hardwired to recognise patterns, which means we can understand information much more easily when it’s presented visually rather than as raw numbers. In today’s data-driven world, the ability to visualise information effectively is more important than ever. Learning to visualise data will equip you with essential skills for analysing and interpreting information, allowing you to communicate insights clearly and persuasively.</p>
<p>Effective visualisation also fosters critical thinking. It helps you identify trends, relationships, and anomalies within datasets, enhancing your analytical abilities and preparing you for future roles in research, industry, and beyond, where data-driven decision-making is key.</p>
<p>This week, we’re going to explore visualisation in R, focusing on creating impactful graphics using its native capabilities. Our objectives include:</p>
<ul>
<li><strong>Histograms</strong>: Visualising the distribution of continuous variables.</li>
<li><strong>Boxplots</strong>: Showing data spread between groups and highlighting outliers.</li>
<li><strong>Scatterplots</strong>: Displaying relationships between two continuous variables.</li>
</ul>
<p>By the end of this chapter, you will be equipped to create these essential visualisations, enhancing your analytical skills and bringing your data to life!</p>
<p>In an effort to ensure that this week’s chapter is relevant to your microbiology lab practicals, I have carefully crafted the following scenario to provide a bit more context for our visualisation.</p>
<div id="mushroom-compost-scenario" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Mushroom Compost Scenario<a href="introduction-to-r-part-ii-visualisation.html#mushroom-compost-scenario" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>MegaMush</strong>, a mushroom compost company based in the Netherlands, is trying to identify an issue with its pre-pasteurisation composting process across its five operational production sites.</p>
<p>You have been hired as an <strong>independent bioscience data consultant</strong> and have been tasked with summarising and visualising a dataset compiled over a period of 1 year and consolidated from each location.</p>
<p>Specifically, you have been asked to generate the following for incorporation into a report that will be presented by the chief technical officer of the company to the extended board of directors:</p>
<ul>
<li>A <strong>summary table</strong> that shows the mean and standard deviations of the composting temperature, moisture, and viable bacterial count, <em>VBC</em> (cfu/g), at each site.</li>
<li>A <strong>histogram</strong> showing the distribution of estimated viable bacterial count, <em>VBC</em> from across all samples.</li>
<li>A grouped <strong>boxplot</strong> showing the distributions of estimated <em>VBC</em> for each site.</li>
<li>A <strong>scatterplot</strong> that shows the relationship between temperature and <em>VBC</em>.</li>
<li>Any additional visualisations (histogram, boxplot or scatterplot) that identify other interesting features in the data.</li>
</ul>
<div id="the-dataset" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> The dataset<a href="introduction-to-r-part-ii-visualisation.html#the-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can download the raw data <a href="https://canvaswizards.org.uk/dataspell/compost/999">here</a> or from the <a href="https://raw.githubusercontent.com/rtreharne/qs/main/data/05/compost_999.csv">backup link</a>.</p>
</div>
<div id="further-information" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Further information<a href="introduction-to-r-part-ii-visualisation.html#further-information" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The compost <strong>temperature</strong> and <strong>moisture content</strong> were measured directly during the sampling process using calibrated thermometers and moisture probes.</p>
<p>After collection, samples were immediately placed into sterile containers to prevent cross-contamination and transported to the central laboratory under refrigerated conditions at 4°C. To ensure the integrity of microbial counts, all samples were processed within 24 hours of collection.</p>
<p>In the laboratory, <strong>0.5g</strong> of each compost sample was dissolved in <strong>10mL</strong> of sterile reagent and mixed thoroughly to create the starting solution for subsequent serial dilution. In each case, a <strong>1/1000</strong> serial dilution was performed and <strong>0.1mL</strong> of the diluted sample was plated onto selective agar media. Plates were incubated for 48 hrs at 30°C before the number of viable colonies were counted.</p>
<p>This procedure was performed regularly for each site, ensuring consistent data collection on microbial counts, temperature, and moisture content across all locations over the course of a year.</p>
<p>Your tables and figures need to be formatted according to the <a href="https://raw.githubusercontent.com/rtreharne/qs/main/data/05/Megamush_template.docx">MegaMush report template</a></p>
</div>
</div>
<div id="inspecting-and-summarising" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Inspecting and Summarising<a href="introduction-to-r-part-ii-visualisation.html#inspecting-and-summarising" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Right then, let’s start. You know the drill by now:</p>
<ul>
<li><strong>Create a New R Project</strong></li>
<li><strong>Download the dataset and move to project folder</strong></li>
<li><strong>Create a new script file and save it with a sensible filename</strong></li>
<li><strong>Read your dataset to a new variable called <code>data</code></strong></li>
</ul>
<p>That should create a <code>data</code> variable in my environment window. I could click on it and look at the data, but that method was so “last week”. This time I’m going to simply add the line <code>head(data)</code> to my script and run it to spit out the first 5 rows of my data (including headers) in my console. Here’s what my script (and its output) looks like so far:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="introduction-to-r-part-ii-visualisation.html#cb23-1" tabindex="-1"></a><span class="co"># Script File: mushroom_summary.R</span></span>
<span id="cb23-2"><a href="introduction-to-r-part-ii-visualisation.html#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="introduction-to-r-part-ii-visualisation.html#cb23-3" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb23-4"><a href="introduction-to-r-part-ii-visualisation.html#cb23-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;compost_999.csv&quot;</span>)</span>
<span id="cb23-5"><a href="introduction-to-r-part-ii-visualisation.html#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="introduction-to-r-part-ii-visualisation.html#cb23-6" tabindex="-1"></a><span class="co"># Output the first 5 rows in console</span></span>
<span id="cb23-7"><a href="introduction-to-r-part-ii-visualisation.html#cb23-7" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##       SampleID   Location   DateTime DayOfWeek Temperature Moisture
## 1 MAA_20230802 Maastricht 2023-08-02 Wednesday        54.8     71.8
## 2 ROT_20230611  Rotterdam 2023-06-11    Sunday        55.5     61.8
## 3 UTR_20230818    Utrecht 2023-08-18    Friday        68.2     78.5
## 4 AMS_20230913  Amsterdam 2023-09-13 Wednesday        57.6     73.0
## 5 UTR_20230619    Utrecht 2023-06-19    Monday        70.5     76.3
## 6 GRO_20231109  Groningen 2023-11-09  Thursday        52.9     70.3
##   Viable.counts
## 1           153
## 2           144
## 3           139
## 4           149
## 5           133
## 6           155</code></pre>
<p>OK. So it doesn’t look too pretty in my console, but I can glean the important information - i.e. the data headers and the types of data that are in each column. The headers are self explanatory , except perhaps for <strong>Viable.counts</strong> which is a direct count of the number of observed colonies formed on each sample plate. This is not to be confused with <strong>Viable Bacterial Count</strong>, VBC, defined as the number of colony forming units per gram (cfu/g).</p>
<h3>
Calculating VBC from Viable Counts
</h3>
<p>To calculate the <strong>Viable Bacterial Count (VBC)</strong> from the <strong>Viable Counts</strong> observed on the agar plates, we need to consider the specific parameters of the laboratory procedure. Here’s how the calculation works step-by-step:</p>
<ol style="list-style-type: decimal">
<li><strong>Viable Counts</strong>: The number of colonies observed on an agar plate after incubation. Let’s denote this <strong>VC</strong></li>
<li><strong>Dilution Factor</strong>: Remember, all starting solutions have undergone a <strong>1/1000</strong> serial dilution.</li>
<li><strong>Volume Plated</strong>: From each diluted sample, <strong>0.1 mL</strong> was plated onto the agar. This means that only <strong>0.1mL</strong> of the diluted solution contributes the visible colonies counted. To express the counts in terms of <strong>1mL</strong>, we must multiply by a factor of <strong>10</strong></li>
<li><strong>Weight of Sample</strong>: Finally, since <strong>0.5 g</strong> of each compost sample was used in the initial preparation, we need to express the results per gram. To convert out counts to reflect the weight of the sample, we divide by the weight used, which is <strong>0.5 g</strong>. This can be expressed as multiplying by a factor of <strong>2</strong>.</li>
</ol>
<p>Putting all this together, the equation to calculate <strong>VBC</strong> from the observed <strong>Viable Counts</strong> can be expressed as:</p>
<p><span class="math display">\[
\text{VBC (cfu/g)} = \text{VC} \times 1000 \times 10 \times 2
\]</span></p>
<p>Thus, the final calculation simplifies to:</p>
<p><span class="math display">\[
\text{VBC (cfu/g)} = \text{VC} \times 20,000
\]</span></p>
<p>This equation indicates that for every viable colony observed, the equivalent VBC is determined by multiplying by a factor of 20,000 to account for the dilution, volume plated, and sample weight, providing a standardised measure of viable bacteria per gram of compost.</p>
<div id="summary-table" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Summary Table<a href="introduction-to-r-part-ii-visualisation.html#summary-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<iframe width="100%" height="400" src="https://www.youtube.com/embed/RajQptd1m30?si=ez-g13JaBEfUEmN1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
</iframe>
<p><br></p>
<p>Let’s tick the first task from the scenario off our list of things to do. Let’s <strong>create a summary table that shows the mean and standard deviations of the composting temperature, moisture, and viable bacterial count, VBC (cfu/g), at each site</strong>.</p>
<p>Curses! I’ve completely forgotten how to create a summary table in R. It’s the end of the world!</p>
<p>No it’s not. Let’s do the obvious (and easy) thing and revisit the script we used in the last chapter to generate a summary table and see if we can tweak things to make it work for us again.</p>
<p>Here’s the original script (or the first couple of lines at least).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="introduction-to-r-part-ii-visualisation.html#cb25-1" tabindex="-1"></a><span class="co"># Read and filter data</span></span>
<span id="cb25-2"><a href="introduction-to-r-part-ii-visualisation.html#cb25-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;pantheria_999.csv&quot;</span>)</span>
<span id="cb25-3"><a href="introduction-to-r-part-ii-visualisation.html#cb25-3" tabindex="-1"></a>data_filtered <span class="ot">&lt;-</span> data[data<span class="sc">$</span>NeonateBodyMass_g <span class="sc">!=</span> <span class="sc">-</span><span class="dv">999</span>, ]</span>
<span id="cb25-4"><a href="introduction-to-r-part-ii-visualisation.html#cb25-4" tabindex="-1"></a></span>
<span id="cb25-5"><a href="introduction-to-r-part-ii-visualisation.html#cb25-5" tabindex="-1"></a><span class="co"># Calculate summary statistics for each Family</span></span>
<span id="cb25-6"><a href="introduction-to-r-part-ii-visualisation.html#cb25-6" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(NeonateBodyMass_g <span class="sc">~</span> Family, data_filtered, <span class="cf">function</span>(x) </span>
<span id="cb25-7"><a href="introduction-to-r-part-ii-visualisation.html#cb25-7" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x), <span class="at">Median =</span> <span class="fu">median</span>(x), <span class="at">Max =</span> <span class="fu">max</span>(x), <span class="at">Min =</span> <span class="fu">min</span>(x), <span class="at">SD =</span> <span class="fu">sd</span>(x), <span class="at">Count =</span> <span class="fu">length</span>(x)))</span>
<span id="cb25-8"><a href="introduction-to-r-part-ii-visualisation.html#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="introduction-to-r-part-ii-visualisation.html#cb25-9" tabindex="-1"></a><span class="co"># Convert the list columns to individual columns</span></span>
<span id="cb25-10"><a href="introduction-to-r-part-ii-visualisation.html#cb25-10" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">do.call</span>(data.frame, summary_table)</span></code></pre></div>
<p>To adapt this script to work for my new “compost_999.csv” I need to consider the following things:</p>
<ol style="list-style-type: decimal">
<li><strong>Update the dataset</strong>: I need to update my <code>read.csv()</code> function by replacing <code>pantheria_999.csv</code> with <code>compost_999.csv</code>.</li>
<li><strong>Filter step removal</strong>: I know that my compost_999.csv dataset has no missing or erroneous data (please take my word for this) so I don’t need to worry about creating a new <code>data_filtered</code> variable. I can delete the line and update the rest of the code to just use my initial <code>data</code> variable throughout.</li>
<li><strong>Adjust the grouping and variables</strong>: In my aggregate function I no longer need to summarise the <code>NeonateBodyMass_g</code> by <code>Family</code>. Instead I want to summarise <code>Temperature</code>, <code>Moisture</code>, and <code>Viable.counts</code> by <code>Location</code>.</li>
<li><strong>Simplify descriptive statistics</strong>: I only need to calculate the mean and standard deviation within my aggregate function this time (forget about median, min and max).</li>
</ol>
<p>With all that in mind, here’s how I’d update the script:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="introduction-to-r-part-ii-visualisation.html#cb26-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;compost_999.csv&quot;</span>)</span>
<span id="cb26-2"><a href="introduction-to-r-part-ii-visualisation.html#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="introduction-to-r-part-ii-visualisation.html#cb26-3" tabindex="-1"></a><span class="co"># Calculate summary statistics for Temperature, Moisture, and Viable counts for each Location</span></span>
<span id="cb26-4"><a href="introduction-to-r-part-ii-visualisation.html#cb26-4" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="fu">cbind</span>(Temperature, Moisture, Viable.counts) <span class="sc">~</span> Location, </span>
<span id="cb26-5"><a href="introduction-to-r-part-ii-visualisation.html#cb26-5" tabindex="-1"></a>                           data, </span>
<span id="cb26-6"><a href="introduction-to-r-part-ii-visualisation.html#cb26-6" tabindex="-1"></a>                           <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x), <span class="at">SD =</span> <span class="fu">sd</span>(x)))</span>
<span id="cb26-7"><a href="introduction-to-r-part-ii-visualisation.html#cb26-7" tabindex="-1"></a></span>
<span id="cb26-8"><a href="introduction-to-r-part-ii-visualisation.html#cb26-8" tabindex="-1"></a><span class="co"># Convert the list columns to individual columns</span></span>
<span id="cb26-9"><a href="introduction-to-r-part-ii-visualisation.html#cb26-9" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">do.call</span>(data.frame, summary_table)</span>
<span id="cb26-10"><a href="introduction-to-r-part-ii-visualisation.html#cb26-10" tabindex="-1"></a></span>
<span id="cb26-11"><a href="introduction-to-r-part-ii-visualisation.html#cb26-11" tabindex="-1"></a><span class="co"># Output table in console</span></span>
<span id="cb26-12"><a href="introduction-to-r-part-ii-visualisation.html#cb26-12" tabindex="-1"></a><span class="fu">print</span>(summary_table)</span></code></pre></div>
<pre><code>##     Location Temperature.Mean Temperature.SD Moisture.Mean Moisture.SD
## 1  Amsterdam         58.25165       2.126257      74.94286    2.028253
## 2  Groningen         54.67905       1.852581      70.03905    1.869157
## 3 Maastricht         56.84135       2.105592      72.42500    2.019793
## 4  Rotterdam         56.82762       2.015302      62.32762    1.971016
## 5    Utrecht         69.69368       2.051456      75.57263    1.743159
##   Viable.counts.Mean Viable.counts.SD
## 1           150.5934         3.602401
## 2           152.0381         3.116099
## 3           150.7404         3.424626
## 4           142.6571         3.292849
## 5           134.0000         3.497720</code></pre>
<p>The biggest difference between the new and old scripts is the use of the <code>cbind()</code> function within my <code>aggregate()</code> function. The <code>cbind()</code> function allows me to group together multiple variables (Temperature, Moisure, Viable Counts) in order to calculate and present their descriptive stats simultaneously. Nice.</p>
<p>Our summary table is nearly complete. The last thing I need to do is calculate two more columns for the mean and standard deviations of the VBC (cfu/g). As I explained above, to get values of VBC I need to multiply my viable counts by a factor of 20,000. Here’s how I’d update my summary table script:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="introduction-to-r-part-ii-visualisation.html#cb28-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;compost_999.csv&quot;</span>)</span>
<span id="cb28-2"><a href="introduction-to-r-part-ii-visualisation.html#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="introduction-to-r-part-ii-visualisation.html#cb28-3" tabindex="-1"></a><span class="co"># Calculate summary statistics for Temperature, Moisture, and Viable counts for each Location</span></span>
<span id="cb28-4"><a href="introduction-to-r-part-ii-visualisation.html#cb28-4" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="fu">cbind</span>(Temperature, Moisture, Viable.counts) <span class="sc">~</span> Location, </span>
<span id="cb28-5"><a href="introduction-to-r-part-ii-visualisation.html#cb28-5" tabindex="-1"></a>                           data, </span>
<span id="cb28-6"><a href="introduction-to-r-part-ii-visualisation.html#cb28-6" tabindex="-1"></a>                           <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x), <span class="at">SD =</span> <span class="fu">sd</span>(x)))</span>
<span id="cb28-7"><a href="introduction-to-r-part-ii-visualisation.html#cb28-7" tabindex="-1"></a></span>
<span id="cb28-8"><a href="introduction-to-r-part-ii-visualisation.html#cb28-8" tabindex="-1"></a><span class="co"># Convert the list columns to individual columns</span></span>
<span id="cb28-9"><a href="introduction-to-r-part-ii-visualisation.html#cb28-9" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">do.call</span>(data.frame, summary_table)</span>
<span id="cb28-10"><a href="introduction-to-r-part-ii-visualisation.html#cb28-10" tabindex="-1"></a></span>
<span id="cb28-11"><a href="introduction-to-r-part-ii-visualisation.html#cb28-11" tabindex="-1"></a><span class="co"># Define variable factor according to calculation for VBC. Divide by 1e7 to express answers in standard form.</span></span>
<span id="cb28-12"><a href="introduction-to-r-part-ii-visualisation.html#cb28-12" tabindex="-1"></a>factor <span class="ot">&lt;-</span> <span class="fl">2e5</span> <span class="sc">/</span> <span class="fl">1e7</span></span>
<span id="cb28-13"><a href="introduction-to-r-part-ii-visualisation.html#cb28-13" tabindex="-1"></a></span>
<span id="cb28-14"><a href="introduction-to-r-part-ii-visualisation.html#cb28-14" tabindex="-1"></a><span class="co"># Calculate additional columns vbc_mean and vbc_sd using factor</span></span>
<span id="cb28-15"><a href="introduction-to-r-part-ii-visualisation.html#cb28-15" tabindex="-1"></a>summary_table<span class="sc">$</span>vbc_mean <span class="ot">&lt;-</span> summary_table<span class="sc">$</span>Viable.counts.Mean <span class="sc">*</span> factor</span>
<span id="cb28-16"><a href="introduction-to-r-part-ii-visualisation.html#cb28-16" tabindex="-1"></a>summary_table<span class="sc">$</span>vbc_sd <span class="ot">&lt;-</span> summary_table<span class="sc">$</span>Viable.counts.SD <span class="sc">*</span> factor</span>
<span id="cb28-17"><a href="introduction-to-r-part-ii-visualisation.html#cb28-17" tabindex="-1"></a></span>
<span id="cb28-18"><a href="introduction-to-r-part-ii-visualisation.html#cb28-18" tabindex="-1"></a><span class="co"># Save table to file</span></span>
<span id="cb28-19"><a href="introduction-to-r-part-ii-visualisation.html#cb28-19" tabindex="-1"></a><span class="fu">write.csv</span>(summary_table, <span class="st">&quot;compost_summary.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-20"><a href="introduction-to-r-part-ii-visualisation.html#cb28-20" tabindex="-1"></a></span>
<span id="cb28-21"><a href="introduction-to-r-part-ii-visualisation.html#cb28-21" tabindex="-1"></a><span class="co"># Output table in console</span></span>
<span id="cb28-22"><a href="introduction-to-r-part-ii-visualisation.html#cb28-22" tabindex="-1"></a><span class="fu">print</span>(summary_table)</span></code></pre></div>
<pre><code>##     Location Temperature.Mean Temperature.SD Moisture.Mean Moisture.SD
## 1  Amsterdam         58.25165       2.126257      74.94286    2.028253
## 2  Groningen         54.67905       1.852581      70.03905    1.869157
## 3 Maastricht         56.84135       2.105592      72.42500    2.019793
## 4  Rotterdam         56.82762       2.015302      62.32762    1.971016
## 5    Utrecht         69.69368       2.051456      75.57263    1.743159
##   Viable.counts.Mean Viable.counts.SD vbc_mean     vbc_sd
## 1           150.5934         3.602401 3.011868 0.07204801
## 2           152.0381         3.116099 3.040762 0.06232198
## 3           150.7404         3.424626 3.014808 0.06849252
## 4           142.6571         3.292849 2.853143 0.06585699
## 5           134.0000         3.497720 2.680000 0.06995439</code></pre>
<p>This script should work for you too. Update your existing script with the code above and check that you get the same output as that above for the example dataset.</p>
<p>Did you notice that I used the <code>write.csv()</code> in the penultimate line? This means that you should now see a file called <strong>summary_table</strong>.csv in your <strong>Files</strong> window. You should import this file into a new Excel workbook, format the numbers to a sensible precision, style it how you like, and then cut and paste it into your <a href="https://raw.githubusercontent.com/rtreharne/qs/main/data/05/Megamush_template.docx">MegaMush report template</a>. Don’t forget to include a table caption according to the <strong>unbreakable rules</strong> stated in Chatper 1.</p>
</div>
</div>
<div id="histogram" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Histogram<a href="introduction-to-r-part-ii-visualisation.html#histogram" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<iframe width="100%" height="400" src="https://www.youtube.com/embed/2hzo4nY0vIw?si=p6YTZcx6eda7LTMv" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
</iframe>
<p><br></p>
<p>Let’s complete the second task on our list: Create a <strong>histogram showing the distribution of estimated viable bacterial count, VBC from across all samples</strong>.</p>
<p>Create a new script file, copy and paste the code below and run the whole file (click the <strong>Source</strong> button). You should see something like that in figure 5.1 in your <strong>Plots</strong> window.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="introduction-to-r-part-ii-visualisation.html#cb30-1" tabindex="-1"></a><span class="co"># Your R code for generating the histogram</span></span>
<span id="cb30-2"><a href="introduction-to-r-part-ii-visualisation.html#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="introduction-to-r-part-ii-visualisation.html#cb30-3" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb30-4"><a href="introduction-to-r-part-ii-visualisation.html#cb30-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;compost_999.csv&quot;</span>)</span>
<span id="cb30-5"><a href="introduction-to-r-part-ii-visualisation.html#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="introduction-to-r-part-ii-visualisation.html#cb30-6" tabindex="-1"></a><span class="co"># Calculate the conversion factor</span></span>
<span id="cb30-7"><a href="introduction-to-r-part-ii-visualisation.html#cb30-7" tabindex="-1"></a>factor <span class="ot">&lt;-</span> <span class="fl">2e5</span> <span class="sc">/</span> <span class="fl">1e7</span></span>
<span id="cb30-8"><a href="introduction-to-r-part-ii-visualisation.html#cb30-8" tabindex="-1"></a></span>
<span id="cb30-9"><a href="introduction-to-r-part-ii-visualisation.html#cb30-9" tabindex="-1"></a><span class="co"># Calculate VBC column</span></span>
<span id="cb30-10"><a href="introduction-to-r-part-ii-visualisation.html#cb30-10" tabindex="-1"></a>data<span class="sc">$</span>vbc <span class="ot">&lt;-</span> data<span class="sc">$</span>Viable.counts <span class="sc">*</span> factor</span>
<span id="cb30-11"><a href="introduction-to-r-part-ii-visualisation.html#cb30-11" tabindex="-1"></a></span>
<span id="cb30-12"><a href="introduction-to-r-part-ii-visualisation.html#cb30-12" tabindex="-1"></a><span class="co"># Calculate the mean VBC</span></span>
<span id="cb30-13"><a href="introduction-to-r-part-ii-visualisation.html#cb30-13" tabindex="-1"></a>vbc_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>vbc)</span>
<span id="cb30-14"><a href="introduction-to-r-part-ii-visualisation.html#cb30-14" tabindex="-1"></a></span>
<span id="cb30-15"><a href="introduction-to-r-part-ii-visualisation.html#cb30-15" tabindex="-1"></a><span class="co"># Generate a simple histogram for all &quot;VBC&quot;</span></span>
<span id="cb30-16"><a href="introduction-to-r-part-ii-visualisation.html#cb30-16" tabindex="-1"></a><span class="fu">hist</span>(data<span class="sc">$</span>vbc,</span>
<span id="cb30-17"><a href="introduction-to-r-part-ii-visualisation.html#cb30-17" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">20</span>,</span>
<span id="cb30-18"><a href="introduction-to-r-part-ii-visualisation.html#cb30-18" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb30-19"><a href="introduction-to-r-part-ii-visualisation.html#cb30-19" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(VBC <span class="sc">~</span> <span class="st">&quot;(&quot;</span> <span class="sc">~</span> x10<span class="sc">^</span><span class="dv">7</span> <span class="sc">~</span> cfu<span class="sc">/</span>g <span class="sc">~</span> <span class="st">&quot;)&quot;</span>), </span>
<span id="cb30-20"><a href="introduction-to-r-part-ii-visualisation.html#cb30-20" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span>,</span>
<span id="cb30-21"><a href="introduction-to-r-part-ii-visualisation.html#cb30-21" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb30-22"><a href="introduction-to-r-part-ii-visualisation.html#cb30-22" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb30-23"><a href="introduction-to-r-part-ii-visualisation.html#cb30-23" tabindex="-1"></a></span>
<span id="cb30-24"><a href="introduction-to-r-part-ii-visualisation.html#cb30-24" tabindex="-1"></a><span class="co"># Add a vertical line for the mean</span></span>
<span id="cb30-25"><a href="introduction-to-r-part-ii-visualisation.html#cb30-25" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> vbc_mean, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb30-26"><a href="introduction-to-r-part-ii-visualisation.html#cb30-26" tabindex="-1"></a></span>
<span id="cb30-27"><a href="introduction-to-r-part-ii-visualisation.html#cb30-27" tabindex="-1"></a><span class="co"># I like a box around my figures</span></span>
<span id="cb30-28"><a href="introduction-to-r-part-ii-visualisation.html#cb30-28" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-39"></span>
<img src="_main_files/figure-html/unnamed-chunk-39-1.png" alt="Histogram of *VBC* of samples taken from all sites over a period of 1 year. The mean *VBC* (dotted red line) is $2.9 \times 10^7$ cfu/g." width="672" />
<p class="caption">
Figure 5.1: Histogram of <em>VBC</em> of samples taken from all sites over a period of 1 year. The mean <em>VBC</em> (dotted red line) is <span class="math inline">\(2.9 \times 10^7\)</span> cfu/g.
</p>
</div>
<p>Let’s break this code down comment by comment:</p>
<ol style="list-style-type: decimal">
<li><strong>Load the Data</strong></li>
</ol>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="introduction-to-r-part-ii-visualisation.html#cb31-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;compost_999.csv&quot;</span>)</span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: This line uses the <code>read.csv()</code> function to read in a CSV file named “compost_999.csv” and stores its content in a data frame variable called <code>data</code></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Calculate the Conversion Factor</strong></li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="introduction-to-r-part-ii-visualisation.html#cb32-1" tabindex="-1"></a>factor <span class="ot">&lt;-</span> <span class="fl">2e5</span> <span class="sc">/</span> <span class="fl">1e7</span></span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: As for the summary table in the section above, this line calculates a conversion factor to convert viable counts into <em>VBC</em> in units of <span class="math inline">\(\times 10^7\)</span> cfu/g.</li>
<li><strong>Scientific Notation</strong>: <code>2e5</code> means <span class="math inline">\(2 \times 10^5\)</span> and <code>1e7</code> means <span class="math inline">\(1 \times 10^7\)</span>.</li>
<li><strong>Why divide by 1e7?</strong>: So that I can quote all VBC values in standard form, e.g. <span class="math inline">\(1.2 \times 10^7\)</span> cfu/g.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Calculate VBC column</strong>:</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="introduction-to-r-part-ii-visualisation.html#cb33-1" tabindex="-1"></a>data<span class="sc">$</span>vbc <span class="ot">&lt;-</span> data<span class="sc">$</span>Viable.counts <span class="sc">*</span> factor</span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: This line creates a new column <code>vbc</code> in the <code>data</code> data frame. It calculates <em>VBM</em> by multiplying the <code>Viable.counts</code> column by the conversion factor.</li>
<li><strong>New Column</strong>: <code>data$vbc</code> stores the calculated <em>VBC</em> for each row in the data frame.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><strong>Calculate the mean VBC</strong></li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="introduction-to-r-part-ii-visualisation.html#cb34-1" tabindex="-1"></a>vbc_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>vbc)</span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: This line computes the mean of the values in the <code>vbc</code> column and stores it to a new variable called <code>vbc_mean</code>. I’ll use this later shortly when I make my histrogram plot.</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><strong>Generate a Simple Histogram for all VBC</strong></li>
</ol>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="introduction-to-r-part-ii-visualisation.html#cb35-1" tabindex="-1"></a><span class="fu">hist</span>(data<span class="sc">$</span>vbc,</span>
<span id="cb35-2"><a href="introduction-to-r-part-ii-visualisation.html#cb35-2" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">20</span>,</span>
<span id="cb35-3"><a href="introduction-to-r-part-ii-visualisation.html#cb35-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb35-4"><a href="introduction-to-r-part-ii-visualisation.html#cb35-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(VBC <span class="sc">~</span> <span class="st">&quot;(&quot;</span> <span class="sc">~</span> x10<span class="sc">^</span><span class="dv">7</span> <span class="sc">~</span> cfu<span class="sc">/</span>g <span class="sc">~</span> <span class="st">&quot;)&quot;</span>), </span>
<span id="cb35-5"><a href="introduction-to-r-part-ii-visualisation.html#cb35-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span>,</span>
<span id="cb35-6"><a href="introduction-to-r-part-ii-visualisation.html#cb35-6" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb35-7"><a href="introduction-to-r-part-ii-visualisation.html#cb35-7" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: This block generates a histogram of the <code>vbc</code> values.</li>
<li><strong>Parameters</strong>:
<ul>
<li><code>breaks = 20</code>: Specifies the number of bins (bars) in the histogram.</li>
<li><code>main = ""</code>: Prevents a title from showing (I’ll use a caption later when I import the image to a document).</li>
<li><code>xlab</code>: Customises the x-label. The <code>expression()</code> function is used to format it, which displays the label as <span class="math inline">\(VBC (\times 10^7 cfu/g)\)</span>.</li>
<li><code>ylab = Frequency</code>: Sets the y-axis label to “Frequency”.</li>
<li><code>col = "lightblue"</code>: Sets the color of the bars in the histogram to light blue.</li>
<li><code>border = "black"</code>: Sets the border color of the bars to black</li>
</ul></li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li><strong>Add a vertical line for the mean</strong></li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="introduction-to-r-part-ii-visualisation.html#cb36-1" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> vbc_mean, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: This line adds a vertical dashed line to the histogram at the mean value <code>vbc_mean</code>.</li>
<li><strong>Parameters</strong>:
<ul>
<li><code>v = vbc_mean</code>: Specifies the x-coordinate where the line is drawn (at the mean value).</li>
<li><code>col = red</code>: Sets the color of the line to red.</li>
<li><code>lwd = 2</code>: Sets the line width to 2 (give a thicker line than the default).</li>
<li><code>lty = 2</code>: Specifies the line type as dashed.</li>
</ul></li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li><strong>I like a box around my histogram</strong></li>
</ol>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="introduction-to-r-part-ii-visualisation.html#cb37-1" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: This command make sure there is a full box around the histogram. By default, only the x and y axes will show otherwise.</li>
</ul>
<h3>
How useful is this histogram?
</h3>
<p>Honestly? Not very. If you were hoping for a nice bell-curve (normal) distribution then you will be disappointed. All the histogram really tells us is that values of <em>VBC</em> are broadly distributed in the range <span class="math inline">\(2.5 - 3.2 \times 10^7\)</span> cfu/g and that there seems to be a slight “skew” towards higher values in the range.</p>
<p>Oh well, at least you now know how to make a histogram using R in the future. Perhaps we could learn a bit more from our second type of visualisation: The Grouped Boxplot.</p>
<p><strong>Feedback Please!</strong></p>
<p>I really value your feedback on these materials for quantitative skills. Please rate them below and then leave some feedback. It’s completely anonymous and will help me improve things if necessary. Say what you like, I have a thick skin - but feel free to leave positive comments as well as negative ones. Thank you.</p>
<iframe src="https://canvaswizards.org.uk/likertysplit/qs/" width="400" style="max-width: 100%" height="600">
</iframe>
</div>
<div id="grouped-boxplot" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Grouped Boxplot<a href="introduction-to-r-part-ii-visualisation.html#grouped-boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I love boxplots. There, I said it. They offer such a great way to visualise how your data is distributed, highlighting clear statistics like the median, quartiles, and potential outliers. But the real clincher is the their ability to compare multiple groups within your dataset at once to let you see if something interesting is going on between them.</p>
<p>Take a look at the script below. Start a new script, copy/paste the code and run all lines. You should see something similar to that shown in figure 5.2 appear.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="introduction-to-r-part-ii-visualisation.html#cb38-1" tabindex="-1"></a><span class="co"># Your R code for generating a grouped boxplot.</span></span>
<span id="cb38-2"><a href="introduction-to-r-part-ii-visualisation.html#cb38-2" tabindex="-1"></a></span>
<span id="cb38-3"><a href="introduction-to-r-part-ii-visualisation.html#cb38-3" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb38-4"><a href="introduction-to-r-part-ii-visualisation.html#cb38-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;compost_999.csv&quot;</span>)</span>
<span id="cb38-5"><a href="introduction-to-r-part-ii-visualisation.html#cb38-5" tabindex="-1"></a></span>
<span id="cb38-6"><a href="introduction-to-r-part-ii-visualisation.html#cb38-6" tabindex="-1"></a><span class="co"># Calculate the conversion factor</span></span>
<span id="cb38-7"><a href="introduction-to-r-part-ii-visualisation.html#cb38-7" tabindex="-1"></a>factor <span class="ot">&lt;-</span> <span class="fl">2e5</span> <span class="sc">/</span> <span class="fl">1e7</span></span>
<span id="cb38-8"><a href="introduction-to-r-part-ii-visualisation.html#cb38-8" tabindex="-1"></a></span>
<span id="cb38-9"><a href="introduction-to-r-part-ii-visualisation.html#cb38-9" tabindex="-1"></a><span class="co"># Calculate VBC column</span></span>
<span id="cb38-10"><a href="introduction-to-r-part-ii-visualisation.html#cb38-10" tabindex="-1"></a>data<span class="sc">$</span>vbc <span class="ot">&lt;-</span> data<span class="sc">$</span>Viable.counts <span class="sc">*</span> factor</span>
<span id="cb38-11"><a href="introduction-to-r-part-ii-visualisation.html#cb38-11" tabindex="-1"></a></span>
<span id="cb38-12"><a href="introduction-to-r-part-ii-visualisation.html#cb38-12" tabindex="-1"></a><span class="co"># Adjust the margins to prevent y-axis label from being cut off</span></span>
<span id="cb38-13"><a href="introduction-to-r-part-ii-visualisation.html#cb38-13" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>))  <span class="co"># Increase the second value for the left margin</span></span>
<span id="cb38-14"><a href="introduction-to-r-part-ii-visualisation.html#cb38-14" tabindex="-1"></a></span>
<span id="cb38-15"><a href="introduction-to-r-part-ii-visualisation.html#cb38-15" tabindex="-1"></a><span class="co"># Generate a grouped boxplot for VBC and group by location</span></span>
<span id="cb38-16"><a href="introduction-to-r-part-ii-visualisation.html#cb38-16" tabindex="-1"></a><span class="fu">boxplot</span>(vbc <span class="sc">~</span> Location, </span>
<span id="cb38-17"><a href="introduction-to-r-part-ii-visualisation.html#cb38-17" tabindex="-1"></a>        <span class="at">data =</span> data, </span>
<span id="cb38-18"><a href="introduction-to-r-part-ii-visualisation.html#cb38-18" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb38-19"><a href="introduction-to-r-part-ii-visualisation.html#cb38-19" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Location&quot;</span>, </span>
<span id="cb38-20"><a href="introduction-to-r-part-ii-visualisation.html#cb38-20" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="fu">expression</span>(VBC <span class="sc">~</span> <span class="st">&quot;(&quot;</span> <span class="sc">~</span> x10<span class="sc">^</span><span class="dv">7</span> <span class="sc">~</span> cfu<span class="sc">/</span>g <span class="sc">~</span> <span class="st">&quot;)&quot;</span>), </span>
<span id="cb38-21"><a href="introduction-to-r-part-ii-visualisation.html#cb38-21" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, </span>
<span id="cb38-22"><a href="introduction-to-r-part-ii-visualisation.html#cb38-22" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb38-23"><a href="introduction-to-r-part-ii-visualisation.html#cb38-23" tabindex="-1"></a>        <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-48"></span>
<img src="_main_files/figure-html/unnamed-chunk-48-1.png" alt="Viable bacterial counts (VBC) across five production sites. Rotterdam and Utrecht exhibit noticeably lower median VBC values compared to the other sites, indicating potential issues at these locations that may require further investigation." width="672" />
<p class="caption">
Figure 5.2: Viable bacterial counts (VBC) across five production sites. Rotterdam and Utrecht exhibit noticeably lower median VBC values compared to the other sites, indicating potential issues at these locations that may require further investigation.
</p>
</div>
<p>You’ll notice that the first three lines of code are identical to the previous histogram example. Let’s break down the boxplot function.</p>
<ol style="list-style-type: decimal">
<li><strong>Adjust the margins to prevent y-axis label superscripts from being cut off</strong></li>
</ol>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="introduction-to-r-part-ii-visualisation.html#cb39-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>))  <span class="co"># Increase the second value for left margin</span></span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: Annoyingly, if I use any label on the y-axis that has superscript elements then the default plot area in R isn’t quite big enough and they get cut off. The <code>par(mar = c(bottom, left, top, right))</code> function adjusts the margins of the plot. By using a value of 5 for the second value (left margin), I’m ensuring that the y-axis is fully visible.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Generate a grouped boxplot for VBC and group by location</strong></li>
</ol>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="introduction-to-r-part-ii-visualisation.html#cb40-1" tabindex="-1"></a><span class="fu">boxplot</span>(vbc <span class="sc">~</span> Location, </span>
<span id="cb40-2"><a href="introduction-to-r-part-ii-visualisation.html#cb40-2" tabindex="-1"></a>        <span class="at">data =</span> data, </span>
<span id="cb40-3"><a href="introduction-to-r-part-ii-visualisation.html#cb40-3" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb40-4"><a href="introduction-to-r-part-ii-visualisation.html#cb40-4" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Location&quot;</span>, </span>
<span id="cb40-5"><a href="introduction-to-r-part-ii-visualisation.html#cb40-5" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="fu">expression</span>(VBC <span class="sc">~</span> <span class="st">&quot;(&quot;</span> <span class="sc">~</span> x10<span class="sc">^</span><span class="dv">7</span> <span class="sc">~</span> cfu<span class="sc">/</span>g <span class="sc">~</span> <span class="st">&quot;)&quot;</span>), </span>
<span id="cb40-6"><a href="introduction-to-r-part-ii-visualisation.html#cb40-6" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, </span>
<span id="cb40-7"><a href="introduction-to-r-part-ii-visualisation.html#cb40-7" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb40-8"><a href="introduction-to-r-part-ii-visualisation.html#cb40-8" tabindex="-1"></a>        <span class="at">cex.axis =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<ul>
<li><strong>Purpose</strong>:</li>
<li><strong>Parameters</strong>:
<ul>
<li><code>vbc ~ Location</code>: This specifies the formula for the boxplot. It creates boxplots of the <code>vbc</code> column data and groups it by the <code>Location</code> factor.</li>
<li><code>data = data</code>: The <code>data</code> argument specifies the data frame containing the variables in the above formula.</li>
<li><code>cex.axis = 0.8</code>: This adjusts the size of the boxplot label text, making it 80% of the default size. I like to do this as it improves readability.</li>
</ul></li>
</ul>
<h3>
Interpreting the Boxplot
</h3>
<p>For a reminder of the important features of a boxplot please refer to <strong>Anatomy of a Boxplot</strong> section in Chapter 2.</p>
<p>The key comparative insight gained from the boxplot is that there is a noticeable trend of lower VBC values at the Rotterdam and Utrecht sites. Whether this trend is statistically significant and the reasons behind the lower values at these two locations remain to be determined. However, if I were the CTO of MegaMush and you presented me with this boxplot, I would likely be making urgent phone calls to my colleagues at the Rotterdam and Utrecht sites to investigate the underlying causes of these discrepancies.</p>
<p>I hope you’ll agree that, unlike the histogram, which provides a general overview of data distribution, the boxplot offers a concise summary of central tendency and variability, making it easier to identify specific trends and outliers across different groups. This clarity is particularly valuable for decision-making, as it allows us to quickly pinpoint areas that require further exploration or intervention.</p>
<h3>
Ideas for Further Exploration
</h3>
<ul>
<li>Boxplot to show distribution of <strong>Temperature</strong> values grouped by <strong>Location</strong>.</li>
<li>Boxplot to show distribution of <strong>Moisture</strong> values grouped by <strong>Location</strong>.</li>
<li>Boxplots of <strong>VBC/Temperature/Moisture</strong> grouped by <strong>DayOfWeek</strong></li>
</ul>
</div>
<div id="scatterplot" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Scatterplot<a href="introduction-to-r-part-ii-visualisation.html#scatterplot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The last thing on our todo list is a scatterplot. Remember, you’ve been asked to plot the relationship between <strong>Temperature</strong> and <em>VBC</em>. I also want to colour code the points by location. Here’s how I’d do this with native R.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="introduction-to-r-part-ii-visualisation.html#cb41-1" tabindex="-1"></a><span class="co"># Your R code for generating a scatterplot.</span></span>
<span id="cb41-2"><a href="introduction-to-r-part-ii-visualisation.html#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="introduction-to-r-part-ii-visualisation.html#cb41-3" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb41-4"><a href="introduction-to-r-part-ii-visualisation.html#cb41-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;compost_999.csv&quot;</span>)</span>
<span id="cb41-5"><a href="introduction-to-r-part-ii-visualisation.html#cb41-5" tabindex="-1"></a></span>
<span id="cb41-6"><a href="introduction-to-r-part-ii-visualisation.html#cb41-6" tabindex="-1"></a><span class="co"># Calculate the conversion factor</span></span>
<span id="cb41-7"><a href="introduction-to-r-part-ii-visualisation.html#cb41-7" tabindex="-1"></a>factor <span class="ot">&lt;-</span> <span class="fl">2e5</span> <span class="sc">/</span> <span class="fl">1e7</span></span>
<span id="cb41-8"><a href="introduction-to-r-part-ii-visualisation.html#cb41-8" tabindex="-1"></a></span>
<span id="cb41-9"><a href="introduction-to-r-part-ii-visualisation.html#cb41-9" tabindex="-1"></a><span class="co"># Calculate VBC column</span></span>
<span id="cb41-10"><a href="introduction-to-r-part-ii-visualisation.html#cb41-10" tabindex="-1"></a>data<span class="sc">$</span>vbc <span class="ot">&lt;-</span> data<span class="sc">$</span>Viable.counts <span class="sc">*</span> factor</span>
<span id="cb41-11"><a href="introduction-to-r-part-ii-visualisation.html#cb41-11" tabindex="-1"></a></span>
<span id="cb41-12"><a href="introduction-to-r-part-ii-visualisation.html#cb41-12" tabindex="-1"></a><span class="co"># Adjust the margins to prevent y-axis label from being cut off</span></span>
<span id="cb41-13"><a href="introduction-to-r-part-ii-visualisation.html#cb41-13" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>))  <span class="co"># Increase the second value for the left margin</span></span>
<span id="cb41-14"><a href="introduction-to-r-part-ii-visualisation.html#cb41-14" tabindex="-1"></a></span>
<span id="cb41-15"><a href="introduction-to-r-part-ii-visualisation.html#cb41-15" tabindex="-1"></a><span class="co"># Define unique locations and corresponding colors</span></span>
<span id="cb41-16"><a href="introduction-to-r-part-ii-visualisation.html#cb41-16" tabindex="-1"></a>unique_locations <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(data<span class="sc">$</span>Location))</span>
<span id="cb41-17"><a href="introduction-to-r-part-ii-visualisation.html#cb41-17" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(unique_locations), <span class="at">alpha=</span><span class="fl">0.8</span>)  <span class="co"># Or use your predefined colors</span></span>
<span id="cb41-18"><a href="introduction-to-r-part-ii-visualisation.html#cb41-18" tabindex="-1"></a></span>
<span id="cb41-19"><a href="introduction-to-r-part-ii-visualisation.html#cb41-19" tabindex="-1"></a><span class="co"># Create a scatterplot of VBC vs. temperature, colored by location</span></span>
<span id="cb41-20"><a href="introduction-to-r-part-ii-visualisation.html#cb41-20" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>Temperature, data<span class="sc">$</span>vbc,</span>
<span id="cb41-21"><a href="introduction-to-r-part-ii-visualisation.html#cb41-21" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb41-22"><a href="introduction-to-r-part-ii-visualisation.html#cb41-22" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Temperature (°C)&quot;</span>,</span>
<span id="cb41-23"><a href="introduction-to-r-part-ii-visualisation.html#cb41-23" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(VBC <span class="sc">~</span> <span class="st">&quot;(&quot;</span> <span class="sc">~</span> x10<span class="sc">^</span><span class="dv">7</span> <span class="sc">~</span> cfu<span class="sc">/</span>g <span class="sc">~</span> <span class="st">&quot;)&quot;</span>),</span>
<span id="cb41-24"><a href="introduction-to-r-part-ii-visualisation.html#cb41-24" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,  <span class="co"># solid circles for points</span></span>
<span id="cb41-25"><a href="introduction-to-r-part-ii-visualisation.html#cb41-25" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.5</span>,  <span class="co"># increase point size</span></span>
<span id="cb41-26"><a href="introduction-to-r-part-ii-visualisation.html#cb41-26" tabindex="-1"></a>     <span class="at">col =</span> colors[<span class="fu">as.numeric</span>(<span class="fu">factor</span>(data<span class="sc">$</span>Location, <span class="at">levels =</span> unique_locations))])  <span class="co"># color by location with transparency</span></span>
<span id="cb41-27"><a href="introduction-to-r-part-ii-visualisation.html#cb41-27" tabindex="-1"></a></span>
<span id="cb41-28"><a href="introduction-to-r-part-ii-visualisation.html#cb41-28" tabindex="-1"></a><span class="co"># Add a legend without a border</span></span>
<span id="cb41-29"><a href="introduction-to-r-part-ii-visualisation.html#cb41-29" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, </span>
<span id="cb41-30"><a href="introduction-to-r-part-ii-visualisation.html#cb41-30" tabindex="-1"></a>       <span class="at">legend =</span> unique_locations,  <span class="co"># Use the unique locations</span></span>
<span id="cb41-31"><a href="introduction-to-r-part-ii-visualisation.html#cb41-31" tabindex="-1"></a>       <span class="at">col =</span> colors,  <span class="co"># Ensure the correct color mapping</span></span>
<span id="cb41-32"><a href="introduction-to-r-part-ii-visualisation.html#cb41-32" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">19</span>,  <span class="co"># same symbol as in the plot</span></span>
<span id="cb41-33"><a href="introduction-to-r-part-ii-visualisation.html#cb41-33" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,  <span class="co"># no box around the legend</span></span>
<span id="cb41-34"><a href="introduction-to-r-part-ii-visualisation.html#cb41-34" tabindex="-1"></a>       <span class="at">pt.cex =</span> <span class="fl">1.5</span>)  <span class="co"># match point size in the legend</span></span>
<span id="cb41-35"><a href="introduction-to-r-part-ii-visualisation.html#cb41-35" tabindex="-1"></a></span>
<span id="cb41-36"><a href="introduction-to-r-part-ii-visualisation.html#cb41-36" tabindex="-1"></a><span class="co"># Add faint gridlines</span></span>
<span id="cb41-37"><a href="introduction-to-r-part-ii-visualisation.html#cb41-37" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray90&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-51"></span>
<img src="_main_files/figure-html/unnamed-chunk-51-1.png" alt="Viable bacterial counts (VBC) vs Temperature. A strong negative correlation is observed. Points are colour coded according to location (see key)." width="672" />
<p class="caption">
Figure 5.3: Viable bacterial counts (VBC) vs Temperature. A strong negative correlation is observed. Points are colour coded according to location (see key).
</p>
</div>
<p>Create a new script file in your existing project, copy/paste the code above and then run as source. Hopefully, you should be able to recreate the scatterplot in your plots window. The first three lines of code are the same as for our boxplot example. Let’s break down the rest comment-by-comment:</p>
<ol style="list-style-type: decimal">
<li><strong>Define Unique Locations and Colors</strong>:</li>
</ol>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="introduction-to-r-part-ii-visualisation.html#cb42-1" tabindex="-1"></a>unique_locations <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(data<span class="sc">$</span>Location))</span>
<span id="cb42-2"><a href="introduction-to-r-part-ii-visualisation.html#cb42-2" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(unique_locations), <span class="at">alpha =</span> <span class="fl">0.8</span>)  <span class="co"># Or use your predefined colors</span></span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: to extract the unique production site locations from the data, sort them alphabetically, and assign each location a distinct colour for visualisation.</li>
<li><strong>Explanation</strong>:
<ul>
<li><code>unique(data$Location)</code>: finds all distinct location values (e.g., Amsterdam, Groningen, etc …).</li>
<li><code>sort()</code>: ensures the locations are listed in alphabetical order, which will also affect how they are represented in the legend.</li>
<li><code>rainbow(length(unique), alpha =0.8)</code>: assigns a unique color to each location, creating a colour palette based on the number of unique locations. The <code>alpha = 0.8</code> parameter makes the points slightly transparent.</li>
</ul></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Create a Scatterplot of VBC vs. Temperature, coloured by Location</strong>:</li>
</ol>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="introduction-to-r-part-ii-visualisation.html#cb43-1" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>Temperature, data<span class="sc">$</span>vbc,</span>
<span id="cb43-2"><a href="introduction-to-r-part-ii-visualisation.html#cb43-2" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb43-3"><a href="introduction-to-r-part-ii-visualisation.html#cb43-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Temperature (°C)&quot;</span>,</span>
<span id="cb43-4"><a href="introduction-to-r-part-ii-visualisation.html#cb43-4" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(VBC <span class="sc">~</span> <span class="st">&quot;(&quot;</span> <span class="sc">~</span> x10<span class="sc">^</span><span class="dv">7</span> <span class="sc">~</span> cfu<span class="sc">/</span>g <span class="sc">~</span> <span class="st">&quot;)&quot;</span>),</span>
<span id="cb43-5"><a href="introduction-to-r-part-ii-visualisation.html#cb43-5" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,  <span class="co"># solid circles for points</span></span>
<span id="cb43-6"><a href="introduction-to-r-part-ii-visualisation.html#cb43-6" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.5</span>,  <span class="co"># increase point size</span></span>
<span id="cb43-7"><a href="introduction-to-r-part-ii-visualisation.html#cb43-7" tabindex="-1"></a>     <span class="at">col =</span> colors[<span class="fu">as.numeric</span>(<span class="fu">factor</span>(data<span class="sc">$</span>Location, <span class="at">levels =</span> unique_locations))])</span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: To create a scatterplot that visualises the relationship between temperature and VBC, with points coloured according to the location of the data.</li>
<li><strong>Explanation</strong>:
<ul>
<li><code>plot(data$Temperature, data$vbc)</code> creates a basic scatterplot of VBC values (on the y-axis) versus temperature (on the x-axis).</li>
<li><code>xlab</code> and <code>ylab</code> provide the axis labels.</li>
<li><code>pch = 19</code> specifies solid circular points for the scatterplot.</li>
<li><code>cex = 1.5</code> increases the size of points for better visibility.</li>
<li><code>factor(data$Location, levels = unique_locations)</code> ensures that the points are coloured by location in the correct, alphabetically sorted order. The <code>as.numeric()</code> converts the factor levels into numeric indices to match with the <code>colors</code> vector.</li>
</ul></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Add a Legend</strong>:</li>
</ol>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="introduction-to-r-part-ii-visualisation.html#cb44-1" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, </span>
<span id="cb44-2"><a href="introduction-to-r-part-ii-visualisation.html#cb44-2" tabindex="-1"></a>       <span class="at">legend =</span> unique_locations,  <span class="co"># Use the unique locations</span></span>
<span id="cb44-3"><a href="introduction-to-r-part-ii-visualisation.html#cb44-3" tabindex="-1"></a>       <span class="at">col =</span> colors,  <span class="co"># Ensure the correct color mapping</span></span>
<span id="cb44-4"><a href="introduction-to-r-part-ii-visualisation.html#cb44-4" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">19</span>,  <span class="co"># same symbol as in the plot</span></span>
<span id="cb44-5"><a href="introduction-to-r-part-ii-visualisation.html#cb44-5" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,  <span class="co"># no box around the legend</span></span>
<span id="cb44-6"><a href="introduction-to-r-part-ii-visualisation.html#cb44-6" tabindex="-1"></a>       <span class="at">pt.cex =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: To add a legend to the plot that identifies the colours representing each location, ensuring the viewer can easily distinguish between the locations.</li>
<li><strong>Explanation</strong>:
<ul>
<li><code>bottom-left</code> determines the location of the legend on your plot.</li>
<li><code>legend = unique_locations</code> ensures the correct, alphabetically sorted location names are shown in the legend.</li>
<li><code>col = colors</code> maps the same colours used in the plot to the corresponding locations in the legend.</li>
<li><code>pch = 19</code> matches the symbol style of the points in the plot with those in the legend.</li>
<li><code>bty = "n"</code> removes the default box around the legend to keep the visual clean.</li>
<li><code>pt.cex = 1.5</code> adjusts the size of the symbols in the legend to match this size of the points in the scatterplot.</li>
</ul></li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><strong>Add Gridlines</strong>:</li>
</ol>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="introduction-to-r-part-ii-visualisation.html#cb45-1" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray90&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>)</span></code></pre></div>
<ul>
<li><strong>Purpose</strong>: Pretty self-explanitory this one I think. I like to have gridlines on my scatterplot as a guide to for the eye, but I leave it as optional for you.</li>
</ul>
<h3>
Interpreting the Scatterplot
</h3>
<p>There’s lots of information radiating out of this plot. Let’s interpret what we’re seeing:</p>
<ul>
<li><strong>Overall Trend</strong>: A clear negative correlation between temperature and VBC.</li>
<li><strong>Utrecht (purple)</strong>: Highest temperatures (65 - 75<sup>o</sup>C) and lowest VBC values.</li>
<li><strong>Rotterdam (blue)</strong>: Slightly lower VBC values for the same range of temperatures as Amsterdam and Groningen. This suggests that there may be another factor affecting VBC at Rotterdam.</li>
</ul>
<p>After seeing this scatterplot I’d be advising the Utrecht site that they were “running hot!” and that they need to cool their compost by about 15<sup>o</sup>C in order to bring their VBCs back in line with the other sites.</p>
<h3>
Ideas for Further Exploration
</h3>
<ul>
<li>Scatterplot of VBC vs Moisture</li>
<li>Scatterplot of Moisture vs Temperature.</li>
</ul>
</div>
<div id="just-for-fun" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Just for Fun<a href="introduction-to-r-part-ii-visualisation.html#just-for-fun" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this last sub-section I just wanted to show you something really cool. The code below uses the fantastlic <strong>Plotly</strong> library to generate a 3D scatterplot so that I can see the impact of both Temperature and Moisture on VBC at the same time. Plotly is not included in your RStudio by default, you’ll need to install it first. Go to your <strong>Console</strong> window and type:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="introduction-to-r-part-ii-visualisation.html#cb46-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;plotly&quot;</span>)</span></code></pre></div>
<p>Hit enter and then wait while the Plotly package is installed. Then start a new script file, copy/past the script below and run it as source.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="introduction-to-r-part-ii-visualisation.html#cb47-1" tabindex="-1"></a><span class="co"># Include the plotly library in your environment</span></span>
<span id="cb47-2"><a href="introduction-to-r-part-ii-visualisation.html#cb47-2" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb47-3"><a href="introduction-to-r-part-ii-visualisation.html#cb47-3" tabindex="-1"></a></span>
<span id="cb47-4"><a href="introduction-to-r-part-ii-visualisation.html#cb47-4" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb47-5"><a href="introduction-to-r-part-ii-visualisation.html#cb47-5" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;compost_999.csv&quot;</span>)</span>
<span id="cb47-6"><a href="introduction-to-r-part-ii-visualisation.html#cb47-6" tabindex="-1"></a></span>
<span id="cb47-7"><a href="introduction-to-r-part-ii-visualisation.html#cb47-7" tabindex="-1"></a><span class="co"># Calculate the conversion factor for cfu per gram</span></span>
<span id="cb47-8"><a href="introduction-to-r-part-ii-visualisation.html#cb47-8" tabindex="-1"></a>factor <span class="ot">&lt;-</span> <span class="fl">2e5</span> <span class="sc">/</span> <span class="fl">1e7</span></span>
<span id="cb47-9"><a href="introduction-to-r-part-ii-visualisation.html#cb47-9" tabindex="-1"></a>data<span class="sc">$</span>vbc <span class="ot">&lt;-</span> data<span class="sc">$</span>Viable.counts <span class="sc">*</span> factor</span>
<span id="cb47-10"><a href="introduction-to-r-part-ii-visualisation.html#cb47-10" tabindex="-1"></a></span>
<span id="cb47-11"><a href="introduction-to-r-part-ii-visualisation.html#cb47-11" tabindex="-1"></a><span class="co"># Create an interactive 3D scatterplot</span></span>
<span id="cb47-12"><a href="introduction-to-r-part-ii-visualisation.html#cb47-12" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> data, </span>
<span id="cb47-13"><a href="introduction-to-r-part-ii-visualisation.html#cb47-13" tabindex="-1"></a>               <span class="at">x =</span> <span class="sc">~</span>Temperature, </span>
<span id="cb47-14"><a href="introduction-to-r-part-ii-visualisation.html#cb47-14" tabindex="-1"></a>               <span class="at">y =</span> <span class="sc">~</span>Moisture,</span>
<span id="cb47-15"><a href="introduction-to-r-part-ii-visualisation.html#cb47-15" tabindex="-1"></a>               <span class="at">z =</span> <span class="sc">~</span>vbc, </span>
<span id="cb47-16"><a href="introduction-to-r-part-ii-visualisation.html#cb47-16" tabindex="-1"></a></span>
<span id="cb47-17"><a href="introduction-to-r-part-ii-visualisation.html#cb47-17" tabindex="-1"></a>               <span class="at">color =</span> <span class="sc">~</span>Location,</span>
<span id="cb47-18"><a href="introduction-to-r-part-ii-visualisation.html#cb47-18" tabindex="-1"></a>               <span class="at">colors =</span> <span class="st">&quot;Set2&quot;</span>,  <span class="co"># Choose a color palette</span></span>
<span id="cb47-19"><a href="introduction-to-r-part-ii-visualisation.html#cb47-19" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">&#39;scatter3d&#39;</span>,</span>
<span id="cb47-20"><a href="introduction-to-r-part-ii-visualisation.html#cb47-20" tabindex="-1"></a>               <span class="at">mode =</span> <span class="st">&#39;markers&#39;</span>,</span>
<span id="cb47-21"><a href="introduction-to-r-part-ii-visualisation.html#cb47-21" tabindex="-1"></a>               <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-22"><a href="introduction-to-r-part-ii-visualisation.html#cb47-22" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">scene =</span> <span class="fu">list</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&#39;Temperature (°C)&#39;</span>),</span>
<span id="cb47-23"><a href="introduction-to-r-part-ii-visualisation.html#cb47-23" tabindex="-1"></a>                      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&#39;VBC&#39;</span>),</span>
<span id="cb47-24"><a href="introduction-to-r-part-ii-visualisation.html#cb47-24" tabindex="-1"></a>                      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&#39;Moisture (%)&#39;</span>)))</span>
<span id="cb47-25"><a href="introduction-to-r-part-ii-visualisation.html#cb47-25" tabindex="-1"></a></span>
<span id="cb47-26"><a href="introduction-to-r-part-ii-visualisation.html#cb47-26" tabindex="-1"></a><span class="co"># Show the figure</span></span>
<span id="cb47-27"><a href="introduction-to-r-part-ii-visualisation.html#cb47-27" tabindex="-1"></a>fig</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-57"></span>
<div class="plotly html-widget html-fill-item" id="htmlwidget-def01b6d672a7d217e36" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-def01b6d672a7d217e36">{"x":{"visdat":{"2e8c91f2ff5":["function () ","plotlyVisDat"]},"cur_data":"2e8c91f2ff5","attrs":{"2e8c91f2ff5":{"x":{},"y":{},"z":{},"mode":"markers","marker":{"size":5},"color":{},"colors":"Set2","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Temperature (°C)"},"zaxis":{"title":"VBC"},"yaxis":{"title":"Moisture (%)"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[57.600000000000001,57.5,61.399999999999999,59.399999999999999,58.200000000000003,59.799999999999997,55.200000000000003,55.399999999999999,59.700000000000003,59.5,57.5,60.899999999999999,56.899999999999999,56.700000000000003,58.399999999999999,60.700000000000003,58.200000000000003,56,62.399999999999999,61.799999999999997,59.100000000000001,57.100000000000001,58.700000000000003,59.5,60.200000000000003,53.799999999999997,60.100000000000001,55,56.700000000000003,58.200000000000003,59,59.799999999999997,57.899999999999999,56.200000000000003,57.399999999999999,58.200000000000003,60.299999999999997,56,55.100000000000001,52.299999999999997,62.899999999999999,57.5,58.600000000000001,56.700000000000003,57.600000000000001,60,57.799999999999997,58.299999999999997,57.899999999999999,57.299999999999997,59.299999999999997,59.600000000000001,54.200000000000003,61.399999999999999,53.100000000000001,57.399999999999999,60.799999999999997,55.100000000000001,58.600000000000001,57.600000000000001,58.600000000000001,61.600000000000001,55.799999999999997,58.799999999999997,56.799999999999997,60.299999999999997,56.600000000000001,58.899999999999999,59.700000000000003,58.399999999999999,54.799999999999997,61.5,55.299999999999997,58.700000000000003,57.299999999999997,58.399999999999999,57.899999999999999,58.799999999999997,58.100000000000001,57.5,59.399999999999999,58,61.100000000000001,63.299999999999997,60.899999999999999,57,58.700000000000003,58.5,58.700000000000003,59.100000000000001,56.899999999999999],"y":[73,74.200000000000003,73.799999999999997,73.599999999999994,76.900000000000006,75.299999999999997,72.900000000000006,76.700000000000003,77.400000000000006,75.700000000000003,76.700000000000003,75.099999999999994,75.900000000000006,79,73.799999999999997,72.799999999999997,75.900000000000006,74.5,72.700000000000003,74.200000000000003,77.599999999999994,71.299999999999997,78.5,75.900000000000006,71.299999999999997,74,71.200000000000003,75.299999999999997,73.799999999999997,75,75.799999999999997,78.5,79,77.799999999999997,75.400000000000006,73.700000000000003,76.299999999999997,76.799999999999997,70.299999999999997,77,74.299999999999997,72.799999999999997,75.200000000000003,73.700000000000003,74.799999999999997,68.900000000000006,77.200000000000003,75.200000000000003,76.200000000000003,77.099999999999994,74.700000000000003,75.599999999999994,74.700000000000003,76.5,71.599999999999994,75.400000000000006,71.900000000000006,73.400000000000006,78.900000000000006,73.700000000000003,74.299999999999997,73.5,76.799999999999997,75.900000000000006,76.400000000000006,74.700000000000003,78.200000000000003,76,73.099999999999994,71.700000000000003,75.099999999999994,75.5,75.099999999999994,75.299999999999997,74.799999999999997,76.099999999999994,71.900000000000006,74.700000000000003,78.799999999999997,75.400000000000006,74.799999999999997,72.599999999999994,75,75.700000000000003,74.599999999999994,73.099999999999994,76.799999999999997,73.599999999999994,76.200000000000003,74,73.700000000000003],"z":[2.98,3,2.9199999999999999,2.96,3.04,2.98,3.0600000000000001,3.1200000000000001,3.02,2.98,3.0600000000000001,2.9399999999999999,3.0800000000000001,3.1200000000000001,3,2.8999999999999999,3.02,3.0800000000000001,2.8399999999999999,2.8799999999999999,3,3,3.0600000000000001,3,2.9199999999999999,3.1200000000000001,2.8799999999999999,3.1200000000000001,3.04,3.02,3,3,3.1000000000000001,3.1200000000000001,3.04,2.98,2.98,3.1000000000000001,3.04,3.2000000000000002,2.8599999999999999,3,3,3.04,3.04,2.8799999999999999,3.04,3.02,3.04,3.0600000000000001,2.96,2.98,3.1400000000000001,2.9399999999999999,3.1200000000000001,3.04,2.8999999999999999,3.0600000000000001,3.0800000000000001,3,3,2.8799999999999999,3.1200000000000001,3.02,3.0600000000000001,2.9399999999999999,3.1200000000000001,3.02,2.9399999999999999,2.98,3.1200000000000001,2.9199999999999999,3.1000000000000001,3.02,3.0600000000000001,3.02,2.98,2.98,3.1000000000000001,3.02,2.98,3,2.9399999999999999,2.8799999999999999,2.9399999999999999,3.02,3.02,2.98,3,2.98,3.04],"mode":"markers","marker":{"color":"rgba(102,194,165,1)","size":5,"line":{"color":"rgba(102,194,165,1)"}},"type":"scatter3d","name":"Amsterdam","textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[52.899999999999999,58.299999999999997,53.299999999999997,53,54.200000000000003,52.200000000000003,53.600000000000001,52.799999999999997,57.5,54.899999999999999,53.200000000000003,57.100000000000001,57.200000000000003,56.600000000000001,53.200000000000003,53.399999999999999,55.700000000000003,50.5,55.399999999999999,54.100000000000001,54.100000000000001,57.600000000000001,54.899999999999999,51.100000000000001,51,54.799999999999997,52.600000000000001,53.200000000000003,56.299999999999997,56.100000000000001,56.200000000000003,54.100000000000001,56,52.700000000000003,58.100000000000001,55.899999999999999,57.600000000000001,54,54.600000000000001,50.799999999999997,53.299999999999997,54.200000000000003,55.5,55.200000000000003,55.299999999999997,54.200000000000003,54.799999999999997,56.399999999999999,56.600000000000001,54.899999999999999,54.399999999999999,57.299999999999997,53.200000000000003,54.600000000000001,52.399999999999999,54.5,53.399999999999999,54.399999999999999,53.700000000000003,55.299999999999997,55,56.600000000000001,54.5,54.5,56.299999999999997,50.5,56.299999999999997,56.600000000000001,55.399999999999999,56.100000000000001,52.600000000000001,55.399999999999999,53.799999999999997,56.5,55.299999999999997,57.299999999999997,54.399999999999999,51.899999999999999,57.600000000000001,56.600000000000001,52.100000000000001,52.600000000000001,54.5,54.5,51.200000000000003,55.100000000000001,55.799999999999997,55.299999999999997,54.700000000000003,53.200000000000003,55,57.799999999999997,57.600000000000001,53.200000000000003,54.299999999999997,51,56.399999999999999,53.899999999999999,56.5,53.299999999999997,57.399999999999999,52.100000000000001,55,56.200000000000003,55],"y":[70.299999999999997,68.200000000000003,70.200000000000003,72.200000000000003,73.400000000000006,70.900000000000006,65.599999999999994,69.599999999999994,70.799999999999997,68.799999999999997,70.099999999999994,69.099999999999994,67.200000000000003,69.799999999999997,70,72.200000000000003,72.400000000000006,68.900000000000006,69.400000000000006,68,71.099999999999994,67,70.299999999999997,70.200000000000003,68.5,72.200000000000003,67.799999999999997,70,71.099999999999994,70.799999999999997,70.799999999999997,68.900000000000006,69.900000000000006,71.900000000000006,70.799999999999997,70.5,67.799999999999997,69.400000000000006,72.299999999999997,71.5,70.200000000000003,71,72.5,70.200000000000003,67.599999999999994,67.299999999999997,69.799999999999997,74.799999999999997,68.099999999999994,70.299999999999997,72.799999999999997,70.700000000000003,69.200000000000003,68.5,72.900000000000006,70.799999999999997,69.700000000000003,69.900000000000006,68.5,70.200000000000003,67.900000000000006,71.099999999999994,70.700000000000003,70.099999999999994,67.5,67.599999999999994,76.200000000000003,68.599999999999994,71.299999999999997,70.099999999999994,67.299999999999997,69.599999999999994,70.400000000000006,70.400000000000006,72.099999999999994,72,72.799999999999997,72.599999999999994,68.799999999999997,70.5,72.799999999999997,71.700000000000003,69.5,70.799999999999997,69.099999999999994,69.700000000000003,64.799999999999997,71.200000000000003,66.599999999999994,69,68.5,69,72.599999999999994,71,69.900000000000006,69.299999999999997,70,69,70.900000000000006,66.5,71.599999999999994,69.099999999999994,68.099999999999994,71.900000000000006,69],"z":[3.1000000000000001,2.8999999999999999,3.1000000000000001,3.1200000000000001,3.1000000000000001,3.1200000000000001,3.02,3.0800000000000001,2.98,3,3.0600000000000001,2.96,2.9199999999999999,2.98,3.0600000000000001,3.1200000000000001,3.04,3.1400000000000001,3,3.02,3.0800000000000001,2.8999999999999999,3.0600000000000001,3.1400000000000001,3.1200000000000001,3.0600000000000001,3.0600000000000001,3.0800000000000001,3.02,3.02,3,3.04,2.98,3.1600000000000001,2.96,3.02,2.9199999999999999,3.0600000000000001,3.0800000000000001,3.1800000000000002,3.0800000000000001,3.0600000000000001,3.0600000000000001,3.04,3,3.02,3.02,3.0800000000000001,2.9399999999999999,3.04,3.1000000000000001,2.98,3.0600000000000001,3,3.1600000000000001,3.0600000000000001,3.0800000000000001,3.0600000000000001,3.04,3.02,3,3,3.0600000000000001,3.0600000000000001,2.96,3.1200000000000001,3.1000000000000001,2.9399999999999999,3.04,3,3.04,3,3.0800000000000001,2.98,3.0600000000000001,3,3.1000000000000001,3.1600000000000001,2.9399999999999999,2.98,3.1600000000000001,3.1400000000000001,3.04,3.0600000000000001,3.1400000000000001,3.02,2.9399999999999999,3.04,2.98,3.0800000000000001,3.02,2.9399999999999999,3.02,3.1000000000000001,3.04,3.1400000000000001,2.98,3.04,2.98,3.02,3,3.1000000000000001,3,3.02,3],"mode":"markers","marker":{"color":"rgba(252,141,98,1)","size":5,"line":{"color":"rgba(252,141,98,1)"}},"type":"scatter3d","name":"Groningen","textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"frame":null},{"x":[54.799999999999997,60.100000000000001,52,59.399999999999999,55,59.700000000000003,57.600000000000001,56.399999999999999,55.600000000000001,56,59,60.399999999999999,60,53.399999999999999,57.799999999999997,57.100000000000001,54.799999999999997,54.100000000000001,56.5,56.100000000000001,56.600000000000001,58.5,56.700000000000003,54.899999999999999,59,56.700000000000003,57,55,56.399999999999999,56.700000000000003,57.600000000000001,53.5,56,55.100000000000001,57.700000000000003,54.600000000000001,54.399999999999999,55.200000000000003,57.100000000000001,60.899999999999999,57.799999999999997,60.600000000000001,56.200000000000003,56.5,57.600000000000001,54.299999999999997,57.100000000000001,60.200000000000003,55.399999999999999,54.299999999999997,60.200000000000003,56.100000000000001,56,57,57.399999999999999,55.700000000000003,57.200000000000003,57.700000000000003,57.5,56.200000000000003,59.700000000000003,56.5,58.899999999999999,58.399999999999999,58,61.100000000000001,53.700000000000003,58.399999999999999,57.100000000000001,54.5,54.799999999999997,52.600000000000001,57.799999999999997,55.600000000000001,61.200000000000003,57.100000000000001,56.5,57.100000000000001,58.600000000000001,56,57.399999999999999,53.299999999999997,54.200000000000003,59.399999999999999,57.200000000000003,55.299999999999997,57.5,53.100000000000001,56.899999999999999,59.399999999999999,57.399999999999999,57.600000000000001,56.899999999999999,56.299999999999997,57.899999999999999,55.100000000000001,54.299999999999997,52.100000000000001,60.799999999999997,61.299999999999997,56.600000000000001,58.5,55.399999999999999,57.600000000000001],"y":[71.799999999999997,69.599999999999994,70.700000000000003,69.900000000000006,70.700000000000003,73.700000000000003,74,75.299999999999997,73.700000000000003,70.900000000000006,68.400000000000006,71.799999999999997,76.400000000000006,71.900000000000006,72.900000000000006,71.299999999999997,73.099999999999994,70,70.599999999999994,70.599999999999994,72.599999999999994,72.200000000000003,73.299999999999997,70.299999999999997,71.299999999999997,75,68.5,74.900000000000006,73.900000000000006,73.700000000000003,74.5,71.5,72,74.700000000000003,73.299999999999997,75.5,70.099999999999994,74.599999999999994,71.599999999999994,71.599999999999994,73.299999999999997,71.200000000000003,71.299999999999997,72.599999999999994,70.299999999999997,71.799999999999997,70,73.799999999999997,73.200000000000003,73.299999999999997,74,71.099999999999994,73.400000000000006,72,68.900000000000006,73.799999999999997,72.400000000000006,72.400000000000006,74.799999999999997,73.200000000000003,75.900000000000006,71,73,71,76.5,74.799999999999997,69.099999999999994,78.299999999999997,68.700000000000003,76.799999999999997,73.299999999999997,73,73.200000000000003,71.799999999999997,69.599999999999994,68.5,74.099999999999994,73.799999999999997,73.299999999999997,75.700000000000003,74.200000000000003,72.599999999999994,70.299999999999997,71.400000000000006,71.400000000000006,72.900000000000006,72,72.799999999999997,72.5,70.5,70.599999999999994,71,73.299999999999997,72.599999999999994,74.799999999999997,73.599999999999994,73.799999999999997,67.900000000000006,72.900000000000006,75,71.900000000000006,72.099999999999994,71.099999999999994,70.400000000000006],"z":[3.0600000000000001,2.8799999999999999,3.1400000000000001,2.8999999999999999,3.04,2.9399999999999999,3.04,3.0600000000000001,3.0800000000000001,3,2.8999999999999999,2.8999999999999999,2.98,3.1000000000000001,3,3,3.0600000000000001,3.0600000000000001,3,3,3.02,2.96,3.04,3.04,2.9399999999999999,3.0600000000000001,2.9399999999999999,3.1400000000000001,3.04,3.04,3.02,3.0800000000000001,3.04,3.1000000000000001,3.02,3.1200000000000001,3.0600000000000001,3.1000000000000001,2.98,2.8799999999999999,2.98,2.8999999999999999,3,3.04,2.96,3.0800000000000001,2.96,2.9399999999999999,3.0800000000000001,3.0800000000000001,2.9399999999999999,3.02,3.0800000000000001,3,2.9399999999999999,3.0600000000000001,2.98,3,3.04,3.04,3.02,3,2.98,2.9399999999999999,3.0600000000000001,2.9199999999999999,3.04,3.0600000000000001,2.96,3.1600000000000001,3.1000000000000001,3.1600000000000001,3,3.0600000000000001,2.8399999999999999,2.9399999999999999,3.0600000000000001,3.04,2.96,3.1000000000000001,3,3.1200000000000001,3.04,2.9199999999999999,2.98,3.0800000000000001,2.98,3.1600000000000001,3.04,2.8999999999999999,2.96,2.96,3.04,3.04,3.02,3.0800000000000001,3.0800000000000001,3.0800000000000001,2.9199999999999999,2.9199999999999999,3,2.96,3.04,2.9399999999999999],"mode":"markers","marker":{"color":"rgba(141,160,203,1)","size":5,"line":{"color":"rgba(141,160,203,1)"}},"type":"scatter3d","name":"Maastricht","textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null},{"x":[55.5,54,57.799999999999997,55.399999999999999,58.299999999999997,57.700000000000003,60.299999999999997,54.799999999999997,53.600000000000001,56.799999999999997,59,55.700000000000003,56.299999999999997,58.100000000000001,59.299999999999997,59.700000000000003,55.5,55.100000000000001,55.899999999999999,54.799999999999997,56.399999999999999,57.100000000000001,54.899999999999999,57.799999999999997,59.100000000000001,54.700000000000003,57.200000000000003,55.600000000000001,54.100000000000001,55.700000000000003,57.700000000000003,57.600000000000001,54.399999999999999,59.899999999999999,56.700000000000003,55,56.700000000000003,58.399999999999999,55.200000000000003,59.899999999999999,54.899999999999999,58.700000000000003,56.399999999999999,56.600000000000001,56.200000000000003,58.899999999999999,59.799999999999997,57.899999999999999,58.200000000000003,56.899999999999999,56.100000000000001,58.100000000000001,55.299999999999997,58.600000000000001,57.5,60.299999999999997,58.299999999999997,55.899999999999999,56.299999999999997,57.299999999999997,55,53.600000000000001,55.899999999999999,53.799999999999997,56.600000000000001,56.100000000000001,55.600000000000001,54.700000000000003,57.600000000000001,54,54.200000000000003,55.799999999999997,56.100000000000001,56.100000000000001,62.200000000000003,57.600000000000001,53.100000000000001,53,59.899999999999999,58.899999999999999,59.200000000000003,55.899999999999999,61.899999999999999,57.799999999999997,57.200000000000003,55.200000000000003,56.799999999999997,55.600000000000001,59.799999999999997,58.700000000000003,52.399999999999999,58.200000000000003,59.299999999999997,56.700000000000003,58,57.5,56.5,55.700000000000003,55.600000000000001,58,56.5,59.100000000000001,58,52,59.600000000000001],"y":[61.799999999999997,62,63.100000000000001,59.399999999999999,59.700000000000003,63.200000000000003,61.799999999999997,61.799999999999997,62.899999999999999,62.799999999999997,60,61.899999999999999,60.5,62.600000000000001,62.399999999999999,62.5,61.600000000000001,62.399999999999999,63.399999999999999,63.100000000000001,61.299999999999997,62.299999999999997,60.5,61.700000000000003,63.700000000000003,61.200000000000003,64.900000000000006,60.600000000000001,60.100000000000001,63.799999999999997,61.700000000000003,64.599999999999994,61.799999999999997,63.299999999999997,65.799999999999997,66.599999999999994,58.700000000000003,60.5,61.700000000000003,60.200000000000003,62.700000000000003,61.399999999999999,65,63.600000000000001,63.600000000000001,62.299999999999997,59.399999999999999,61.299999999999997,62.799999999999997,62.100000000000001,59.5,61.5,66.700000000000003,65.599999999999994,60.899999999999999,64.700000000000003,64.799999999999997,61.200000000000003,67,62.399999999999999,60.100000000000001,60,64.5,65.400000000000006,61.399999999999999,64.700000000000003,61.799999999999997,57.899999999999999,66.299999999999997,61,60.799999999999997,61,61.700000000000003,64.400000000000006,63,61.799999999999997,63.299999999999997,62.100000000000001,63.100000000000001,63.399999999999999,61.100000000000001,62.5,63.299999999999997,62.100000000000001,61.799999999999997,59.600000000000001,58.299999999999997,60.600000000000001,59.700000000000003,62.100000000000001,60.799999999999997,63.700000000000003,63.299999999999997,63.399999999999999,63.299999999999997,62,67.5,60,63.799999999999997,63,60.299999999999997,67.400000000000006,61.600000000000001,60.200000000000003,62.899999999999999],"z":[2.8799999999999999,2.96,2.8599999999999999,2.8599999999999999,2.7600000000000002,2.8599999999999999,2.7400000000000002,2.9199999999999999,2.96,2.8799999999999999,2.7400000000000002,2.8799999999999999,2.8399999999999999,2.8199999999999998,2.7800000000000002,2.7600000000000002,2.8799999999999999,2.8999999999999999,2.8799999999999999,2.9399999999999999,2.8199999999999998,2.8399999999999999,2.8999999999999999,2.8000000000000003,2.8199999999999998,2.8999999999999999,2.8799999999999999,2.8599999999999999,2.8999999999999999,2.8999999999999999,2.8199999999999998,2.8799999999999999,2.8999999999999999,2.7800000000000002,2.9199999999999999,2.98,2.8000000000000003,2.7800000000000002,2.8799999999999999,2.7200000000000002,2.9199999999999999,2.7800000000000002,2.8999999999999999,2.8599999999999999,2.8999999999999999,2.8000000000000003,2.7200000000000002,2.8199999999999998,2.8399999999999999,2.8399999999999999,2.8199999999999998,2.8199999999999998,2.98,2.8599999999999999,2.8000000000000003,2.7800000000000002,2.8599999999999999,2.8599999999999999,2.96,2.8399999999999999,2.8599999999999999,2.8999999999999999,2.9199999999999999,2.98,2.8399999999999999,2.9199999999999999,2.8599999999999999,2.8399999999999999,2.8799999999999999,2.9199999999999999,2.8999999999999999,2.8599999999999999,2.8799999999999999,2.9199999999999999,2.7000000000000002,2.8399999999999999,2.98,2.96,2.7600000000000002,2.8000000000000003,2.7800000000000002,2.8799999999999999,2.7000000000000002,2.8199999999999998,2.8399999999999999,2.8599999999999999,2.7800000000000002,2.8599999999999999,2.7000000000000002,2.7800000000000002,2.96,2.8399999999999999,2.7800000000000002,2.8799999999999999,2.8399999999999999,2.8399999999999999,2.9199999999999999,2.8399999999999999,2.9199999999999999,2.8199999999999998,2.8399999999999999,2.8799999999999999,2.8199999999999998,2.96,2.7800000000000002],"mode":"markers","marker":{"color":"rgba(231,138,195,1)","size":5,"line":{"color":"rgba(231,138,195,1)"}},"type":"scatter3d","name":"Rotterdam","textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"frame":null},{"x":[68.200000000000003,70.5,69.599999999999994,71.5,69.900000000000006,71.400000000000006,70.5,71.200000000000003,67.900000000000006,75.200000000000003,73.099999999999994,67.5,70.799999999999997,68.700000000000003,69.400000000000006,68.5,65.5,69,67.599999999999994,69.799999999999997,66.299999999999997,66,66.5,65,69.900000000000006,70.799999999999997,71.5,65.5,69.700000000000003,68.799999999999997,69.400000000000006,70,67.200000000000003,69.099999999999994,73.5,70.799999999999997,71.200000000000003,70.599999999999994,71.599999999999994,70.599999999999994,70.299999999999997,69.400000000000006,70.700000000000003,71.200000000000003,71.799999999999997,71.099999999999994,68.400000000000006,71.5,69.400000000000006,72.5,71.700000000000003,68.5,70.599999999999994,67.5,68.599999999999994,67.299999999999997,72,70.700000000000003,73.200000000000003,67.700000000000003,69.099999999999994,71.599999999999994,68.900000000000006,68.099999999999994,69.799999999999997,70.400000000000006,68.700000000000003,68.400000000000006,72.400000000000006,66.5,67.5,69,73.400000000000006,69.200000000000003,71.700000000000003,69.299999999999997,72.599999999999994,72.400000000000006,69.400000000000006,67.700000000000003,70.099999999999994,66.700000000000003,68.599999999999994,71.5,72.099999999999994,66.200000000000003,71,73.099999999999994,67.5,69.400000000000006,71.400000000000006,69.099999999999994,67.700000000000003,69,67.5],"y":[78.5,76.299999999999997,74.400000000000006,75.599999999999994,73.900000000000006,73.599999999999994,76.799999999999997,74.599999999999994,77.900000000000006,73.5,74.799999999999997,76.400000000000006,78.099999999999994,78.799999999999997,76.299999999999997,75.099999999999994,71.5,74.900000000000006,77.5,72.799999999999997,76.900000000000006,77.5,78.700000000000003,74.400000000000006,75.799999999999997,76.200000000000003,75.200000000000003,74.5,76.400000000000006,72.099999999999994,76.200000000000003,81.400000000000006,75.599999999999994,74.599999999999994,75.700000000000003,76.700000000000003,74.099999999999994,73.799999999999997,77.5,75,73.900000000000006,79.099999999999994,77.900000000000006,75.900000000000006,74.599999999999994,76.799999999999997,74.299999999999997,76.900000000000006,79.5,75.599999999999994,76.5,73.400000000000006,76.099999999999994,77.400000000000006,76.299999999999997,72.700000000000003,74.799999999999997,76,75.900000000000006,74.799999999999997,76.799999999999997,74.5,72.700000000000003,74.400000000000006,74.900000000000006,73.299999999999997,75.099999999999994,75.799999999999997,75.200000000000003,74.400000000000006,75.900000000000006,75,74,73.099999999999994,77.799999999999997,75.700000000000003,74.299999999999997,73.599999999999994,75.099999999999994,77,75.700000000000003,74.700000000000003,76.900000000000006,76.099999999999994,76.900000000000006,74,72.900000000000006,75.200000000000003,75.299999999999997,77.700000000000003,73.900000000000006,73.900000000000006,77.299999999999997,75.5,76.799999999999997],"z":[2.7800000000000002,2.6600000000000001,2.6800000000000002,2.6200000000000001,2.6400000000000001,2.6000000000000001,2.6800000000000002,2.6200000000000001,2.7800000000000002,2.5,2.5600000000000001,2.7600000000000002,2.6800000000000002,2.7600000000000002,2.7000000000000002,2.7000000000000002,2.7400000000000002,2.7000000000000002,2.7800000000000002,2.6200000000000001,2.8000000000000003,2.8000000000000003,2.8199999999999998,2.8000000000000003,2.6800000000000002,2.6600000000000001,2.6200000000000001,2.7800000000000002,2.7000000000000002,2.6600000000000001,2.6800000000000002,2.7400000000000002,2.7800000000000002,2.6800000000000002,2.5600000000000001,2.6600000000000001,2.6200000000000001,2.6200000000000001,2.6600000000000001,2.6400000000000001,2.6200000000000001,2.7600000000000002,2.7000000000000002,2.6400000000000001,2.6000000000000001,2.6600000000000001,2.6800000000000002,2.6400000000000001,2.7600000000000002,2.6000000000000001,2.6400000000000001,2.6800000000000002,2.6800000000000002,2.7800000000000002,2.7200000000000002,2.7200000000000002,2.6000000000000001,2.6400000000000001,2.5600000000000001,2.7400000000000002,2.7200000000000002,2.6000000000000001,2.6600000000000001,2.7000000000000002,2.6600000000000001,2.6200000000000001,2.7200000000000002,2.7200000000000002,2.6000000000000001,2.7600000000000002,2.7600000000000002,2.6800000000000002,2.54,2.6400000000000001,2.6400000000000001,2.6800000000000002,2.5800000000000001,2.5800000000000001,2.6600000000000001,2.7600000000000002,2.6600000000000001,2.7400000000000002,2.7400000000000002,2.6400000000000001,2.6200000000000001,2.7600000000000002,2.6000000000000001,2.5600000000000001,2.7400000000000002,2.7400000000000002,2.6200000000000001,2.6800000000000002,2.7800000000000002,2.7200000000000002,2.7800000000000002],"mode":"markers","marker":{"color":"rgba(166,216,84,1)","size":5,"line":{"color":"rgba(166,216,84,1)"}},"type":"scatter3d","name":"Utrecht","textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 5.4: A 3D scatterplot showing Viable bacterial counts (VBC) vs both Temperature AND Moisture using the fantastic Plotly package.
</p>
</div>
<p>How cool is that? You have an interactive, 3D graph that you can fiddle with and investigate the relationship between VBC, Temperature and Moisture.</p>
</div>
<div id="complete-your-weekly-assignments-4" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Complete your Weekly Assignments<a href="introduction-to-r-part-ii-visualisation.html#complete-your-weekly-assignments-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the BIOS103 Canvas course you will find this week’s <strong>summative</strong> QS assignments. There is no <strong>formative</strong> assignment this week! You should aim to complete the summative assignment before the end of the online workshop that corresponds to this section’s content.</p>
<ul>
<li>You can attempt the <strong>summative</strong> assignment <strong>only once</strong>. This assignment <strong>will</strong> contribute to your overall score for this course. Failure to complete a summative test before the stated deadline will result in a zero score. You will not receive immediate feedback after submitting summative assignments. Typically, your scores will be posted within 7 days.</li>
</ul>
<p>In <strong>ALL</strong> cases, when you click the button to “begin” a test you will have two hours to complete and submit the questions. If the test times out it will automatically submit.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-r-part-i.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
