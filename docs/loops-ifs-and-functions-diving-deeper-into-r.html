<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Loops, Ifs and Functions: Diving Deeper into R | Quantitative Skills in Biosciences I</title>
  <meta name="description" content="8 Loops, Ifs and Functions: Diving Deeper into R | Quantitative Skills in Biosciences I" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Loops, Ifs and Functions: Diving Deeper into R | Quantitative Skills in Biosciences I" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Loops, Ifs and Functions: Diving Deeper into R | Quantitative Skills in Biosciences I" />
  
  
  

<meta name="author" content="R. E. Treharne" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistics-in-r-part-ii.html"/>
<link rel="next" href="appendix.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Cover</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to Excel and R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#estimating-the-volume-of-a-snail"><i class="fa fa-check"></i><b>1.1</b> Estimating the Volume of a Snail</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#download-and-import-the-csv-file"><i class="fa fa-check"></i><b>1.1.1</b> Download and Import the CSV File</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#calculate-volume-v-in-excel"><i class="fa fa-check"></i><b>1.1.2</b> Calculate Volume <span class="math inline">\(V\)</span> in Excel</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#add-a-linear-trendline-and-equation"><i class="fa fa-check"></i><b>1.1.3</b> Add a Linear Trendline and Equation</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#estimation-of-volume-for-a-snail-with-mass-10g"><i class="fa fa-check"></i><b>1.1.4</b> Estimation of Volume for a Snail with Mass 10g</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#getting-ready-for-R"><i class="fa fa-check"></i><b>1.2</b> Getting Ready for R</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#download-and-install-windows-and-mac-only"><i class="fa fa-check"></i><b>1.2.1</b> Download and Install (Windows and Mac only)</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#creating-your-first-r-project-in-rstudio"><i class="fa fa-check"></i><b>1.2.2</b> Creating Your First R Project in RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#something-more-complicated"><i class="fa fa-check"></i><b>1.2.3</b> Something More Complicated</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-excel-and-r.html"><a href="introduction-to-excel-and-r.html#complete-your-weekly-assignments"><i class="fa fa-check"></i><b>1.3</b> Complete your Weekly Assignments</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html"><i class="fa fa-check"></i><b>2</b> Summarising Data and ANOVA in Excel</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#summarising-data"><i class="fa fa-check"></i><b>2.1</b> Summarising Data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#download-and-import-the-csv-file-1"><i class="fa fa-check"></i><b>2.1.1</b> Download and Import the CSV File</a></li>
<li class="chapter" data-level="2.1.2" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#generating-a-summary-table"><i class="fa fa-check"></i><b>2.1.2</b> Generating a Summary Table</a></li>
<li class="chapter" data-level="2.1.3" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#presenting-your-summary-table"><i class="fa fa-check"></i><b>2.1.3</b> Presenting Your Summary Table</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#anova"><i class="fa fa-check"></i><b>2.2</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#grouped-boxplots-in-excel"><i class="fa fa-check"></i><b>2.2.1</b> Grouped Boxplots in Excel</a></li>
<li class="chapter" data-level="2.2.2" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#constructing-testable-hypotheses"><i class="fa fa-check"></i><b>2.2.2</b> Constructing Testable Hypotheses</a></li>
<li class="chapter" data-level="2.2.3" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#performing-a-one-way-anova-in-excel"><i class="fa fa-check"></i><b>2.2.3</b> Performing a One-Way Anova in Excel</a></li>
<li class="chapter" data-level="2.2.4" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#post-hoc-tests"><i class="fa fa-check"></i><b>2.2.4</b> Performing Post-hoc Tests in Excel</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarising-data-and-anova-in-excel.html"><a href="summarising-data-and-anova-in-excel.html#complete-your-weekly-assignments-1"><i class="fa fa-check"></i><b>2.3</b> Complete your Weekly Assignments</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html"><i class="fa fa-check"></i><b>3</b> Calibration Curves and Linear Regression in Excel</a>
<ul>
<li class="chapter" data-level="3.1" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#calibration-curves"><i class="fa fa-check"></i><b>3.1</b> Calibration Curves</a></li>
<li class="chapter" data-level="3.2" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#linear-regression"><i class="fa fa-check"></i><b>3.2</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#the-linear-regression-equation"><i class="fa fa-check"></i><b>3.2.1</b> The Linear Regression Equation</a></li>
<li class="chapter" data-level="3.2.2" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#performing-a-linear-regression-in-excel"><i class="fa fa-check"></i><b>3.2.2</b> Performing a Linear Regression in Excel</a></li>
<li class="chapter" data-level="3.2.3" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#interpreting-your-linear-regression"><i class="fa fa-check"></i><b>3.2.3</b> Interpreting Your Linear Regression</a></li>
<li class="chapter" data-level="3.2.4" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#making-predictions-with-our-model"><i class="fa fa-check"></i><b>3.2.4</b> Making Predictions with Our Model</a></li>
<li class="chapter" data-level="3.2.5" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#extending-to-multiple-variables"><i class="fa fa-check"></i><b>3.2.5</b> Extending to Multiple Variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="calibration-curves-and-linear-regression-in-excel.html"><a href="calibration-curves-and-linear-regression-in-excel.html#complete-your-weekly-assignments-2"><i class="fa fa-check"></i><b>3.3</b> Complete your Weekly Assignments</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html"><i class="fa fa-check"></i><b>4</b> Introduction to R: Part I</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#reading-and-inspecting-data"><i class="fa fa-check"></i><b>4.1</b> Reading and Inspecting Data</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#subsetting"><i class="fa fa-check"></i><b>4.2</b> Subsetting</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#slicing"><i class="fa fa-check"></i><b>4.2.1</b> Slicing</a></li>
<li class="chapter" data-level="4.2.2" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#filtering"><i class="fa fa-check"></i><b>4.2.2</b> Filtering</a></li>
<li class="chapter" data-level="4.2.3" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#so-what"><i class="fa fa-check"></i><b>4.2.3</b> So what?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#summarising-data-in-r"><i class="fa fa-check"></i><b>4.3</b> Summarising Data in R</a></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-r-part-i.html"><a href="introduction-to-r-part-i.html#complete-your-weekly-assignments-3"><i class="fa fa-check"></i><b>4.4</b> Complete your Weekly Assignments</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html"><i class="fa fa-check"></i><b>5</b> Introduction to R part II: Visualisation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#mushroom-compost-scenario"><i class="fa fa-check"></i><b>5.1</b> Mushroom Compost Scenario</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#the-dataset"><i class="fa fa-check"></i><b>5.1.1</b> The dataset</a></li>
<li class="chapter" data-level="5.1.2" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#further-information"><i class="fa fa-check"></i><b>5.1.2</b> Further information</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#inspecting-and-summarising"><i class="fa fa-check"></i><b>5.2</b> Inspecting and Summarising</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#summary-table"><i class="fa fa-check"></i><b>5.2.1</b> Summary Table</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#histogram"><i class="fa fa-check"></i><b>5.3</b> Histogram</a></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#grouped-boxplot"><i class="fa fa-check"></i><b>5.4</b> Grouped Boxplot</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#scatterplot"><i class="fa fa-check"></i><b>5.5</b> Scatterplot</a></li>
<li class="chapter" data-level="5.6" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#just-for-fun"><i class="fa fa-check"></i><b>5.6</b> Just for Fun</a></li>
<li class="chapter" data-level="5.7" data-path="introduction-to-r-part-ii-visualisation.html"><a href="introduction-to-r-part-ii-visualisation.html#complete-your-weekly-assignments-4"><i class="fa fa-check"></i><b>5.7</b> Complete your Weekly Assignments</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html"><i class="fa fa-check"></i><b>6</b> Statistics in R: Part I</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html#one-way-anova-in-r"><i class="fa fa-check"></i><b>6.1</b> One-Way ANOVA in R</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html#importing-data-from-an-online-source"><i class="fa fa-check"></i><b>6.1.1</b> Importing Data from an Online Source</a></li>
<li class="chapter" data-level="6.1.2" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html#summarising-descriptive-statistics"><i class="fa fa-check"></i><b>6.1.2</b> Summarising (Descriptive Statistics)</a></li>
<li class="chapter" data-level="6.1.3" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html#grouped-boxplots-in-r"><i class="fa fa-check"></i><b>6.1.3</b> Grouped Boxplots in R</a></li>
<li class="chapter" data-level="6.1.4" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html#conducting-a-one-way-anova"><i class="fa fa-check"></i><b>6.1.4</b> Conducting a One-Way ANOVA</a></li>
<li class="chapter" data-level="6.1.5" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html#post-hoc-tests-1"><i class="fa fa-check"></i><b>6.1.5</b> Post-Hoc Tests</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html#two-way-anova-in-r"><i class="fa fa-check"></i><b>6.2</b> Two-way ANOVA in R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html#importing-and-cleaning-the-data"><i class="fa fa-check"></i><b>6.2.1</b> Importing and Cleaning the Data</a></li>
<li class="chapter" data-level="6.2.2" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html#visualising-the-data"><i class="fa fa-check"></i><b>6.2.2</b> Visualising the data</a></li>
<li class="chapter" data-level="6.2.3" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html#conducting-a-two-way-anova"><i class="fa fa-check"></i><b>6.2.3</b> Conducting a Two-Way ANOVA</a></li>
<li class="chapter" data-level="6.2.4" data-path="statistics-in-r-part-i.html"><a href="statistics-in-r-part-i.html#post-hoc-tests-2"><i class="fa fa-check"></i><b>6.2.4</b> Post-Hoc tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistics-in-r-part-ii.html"><a href="statistics-in-r-part-ii.html"><i class="fa fa-check"></i><b>7</b> Statistics in R: Part II</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistics-in-r-part-ii.html"><a href="statistics-in-r-part-ii.html#linear-regression-in-r"><i class="fa fa-check"></i><b>7.1</b> Linear Regression in R</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="statistics-in-r-part-ii.html"><a href="statistics-in-r-part-ii.html#reading-the-data-and-calculating-a-survival-column"><i class="fa fa-check"></i><b>7.1.1</b> Reading the data and calculating a survival column</a></li>
<li class="chapter" data-level="7.1.2" data-path="statistics-in-r-part-ii.html"><a href="statistics-in-r-part-ii.html#visualising-the-data-1"><i class="fa fa-check"></i><b>7.1.2</b> Visualising the data</a></li>
<li class="chapter" data-level="7.1.3" data-path="statistics-in-r-part-ii.html"><a href="statistics-in-r-part-ii.html#linearising-the-data"><i class="fa fa-check"></i><b>7.1.3</b> Linearising the data</a></li>
<li class="chapter" data-level="7.1.4" data-path="statistics-in-r-part-ii.html"><a href="statistics-in-r-part-ii.html#performing-a-linear-regression-in-r"><i class="fa fa-check"></i><b>7.1.4</b> Performing a Linear Regression in R</a></li>
<li class="chapter" data-level="7.1.5" data-path="statistics-in-r-part-ii.html"><a href="statistics-in-r-part-ii.html#calculating-ld50"><i class="fa fa-check"></i><b>7.1.5</b> Calculating LD50</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="statistics-in-r-part-ii.html"><a href="statistics-in-r-part-ii.html#multiple-linear-regression-mlr-in-r."><i class="fa fa-check"></i><b>7.2</b> Multiple Linear Regression (MLR) in R.</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="statistics-in-r-part-ii.html"><a href="statistics-in-r-part-ii.html#performing-an-mlr-in-r"><i class="fa fa-check"></i><b>7.2.1</b> Performing an MLR in R</a></li>
<li class="chapter" data-level="7.2.2" data-path="statistics-in-r-part-ii.html"><a href="statistics-in-r-part-ii.html#predicting-values-for-viable-counts"><i class="fa fa-check"></i><b>7.2.2</b> Predicting values for Viable Counts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="loops-ifs-and-functions-diving-deeper-into-r.html"><a href="loops-ifs-and-functions-diving-deeper-into-r.html"><i class="fa fa-check"></i><b>8</b> Loops, Ifs and Functions: Diving Deeper into R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="loops-ifs-and-functions-diving-deeper-into-r.html"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#what-is-fasta"><i class="fa fa-check"></i><b>8.1</b> What is FASTA?</a></li>
<li class="chapter" data-level="8.2" data-path="loops-ifs-and-functions-diving-deeper-into-r.html"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#extracting-sequences-from-a-fasta-file"><i class="fa fa-check"></i><b>8.2</b> Extracting Sequences from a FASTA File</a></li>
<li class="chapter" data-level="8.3" data-path="loops-ifs-and-functions-diving-deeper-into-r.html"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#writing-functional-code"><i class="fa fa-check"></i><b>8.3</b> Writing Functional Code</a></li>
<li class="chapter" data-level="8.4" data-path="loops-ifs-and-functions-diving-deeper-into-r.html"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#counting-motifs"><i class="fa fa-check"></i><b>8.4</b> Counting Motifs</a></li>
<li class="chapter" data-level="8.5" data-path="loops-ifs-and-functions-diving-deeper-into-r.html"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#section"><i class="fa fa-check"></i><b>8.5</b> </a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix I: Teach yourself R.</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#linkedin-learning"><i class="fa fa-check"></i>LinkedIn Learning</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#youtube"><i class="fa fa-check"></i>YouTube</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#books"><i class="fa fa-check"></i>Books</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="feedback.html"><a href="feedback.html"><i class="fa fa-check"></i>Appendix II: Feedback</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Skills in Biosciences I</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="loops-ifs-and-functions-diving-deeper-into-r" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Loops, Ifs and Functions: Diving Deeper into R<a href="loops-ifs-and-functions-diving-deeper-into-r.html#loops-ifs-and-functions-diving-deeper-into-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>If you are currently participating in a timetabled BIOS103 QS workshop, please ensure that you cover <strong>all of this section’s content</strong> and complete this week’s <strong>formative and summative assessments</strong> in the BIOS103 Canvas Course.</p>
<p>You’ve already accomplished so much. Far more than any previous first-year student at this point in their course. In previous years, we wouldn’t even have started coding yet! But look at you: you can already read files, generate summary tables, visualise data, and perform some statistical tests in R. That’s incredible progress.</p>
<p>Now, it’s time to take things to the next level. We’re diving deep into some real coding fundamentals, and seeking to develop the kind of skills that will serve you no matter what programming language you use in the future. Our focus will be on genomic data, specifically FASTA files, a universal format for storing genomic and proteomic information. This is where coding starts to show its true power: the ability to automate complex tasks with speed and precision.</p>
<p>You might find yourself struggling at this stage. That’s completely normal. In fact, it’s expected. I’m deliberately challenging you to step out of your comfort zone and develop the resilience and problem-solving skills that every successful student needs.</p>
<p>Remember, you’re not in this alone. The team and I are here to support you every step of the way. Whether you attend the workshops via Microsoft Teams, engagement is key. I strongly recommend coming in person if you can — it’s much easier to troubleshoot and offer immediate help face-to-face.</p>
<p>So, take a deep breath. You’ve got this. Let’s unlock the true potential of coding together! Here are this weeks <strong>learning objectives</strong>:</p>
<ul>
<li>Understand how to use <strong>for loops</strong> to repeat tasks efficiently.</li>
<li>Learn how to apply <strong>if statements</strong> to control the flow of your code with logical conditions.</li>
<li>Gain skills in <strong>building functions</strong> to simplify complex tasks and increase code reusability.</li>
<li>Organise your scripts effectively so you can call your pre-built functions whenever needed and minimise clutter.</li>
<li>Master the use of <strong>sapply</strong> to speed up operations and save valuable time when working with data.</li>
</ul>
<div id="what-is-fasta" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> What is FASTA?<a href="loops-ifs-and-functions-diving-deeper-into-r.html#what-is-fasta" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="extracting-sequences-from-a-fasta-file" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Extracting Sequences from a FASTA File<a href="loops-ifs-and-functions-diving-deeper-into-r.html#extracting-sequences-from-a-fasta-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Start a new R project and create a new R script called <strong>“fasta-tools.R”</strong>. Download the <a href="">genomic_data_100.fasta</a> example file and move it to your project directory.</p>
<p>Copy and paste the code block below into your script and run each line in turn.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-1" tabindex="-1"></a><span class="co"># FILE: fasta-tools.R</span></span>
<span id="cb1-2"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-3" tabindex="-1"></a><span class="co"># The following code will read the sequences from the example FASTA file</span></span>
<span id="cb1-4"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-5" tabindex="-1"></a><span class="co"># Specify filename of example FASTA file</span></span>
<span id="cb1-6"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-6" tabindex="-1"></a>fasta_file <span class="ot">&lt;-</span> <span class="st">&quot;genomic_data_100.fasta&quot;</span></span>
<span id="cb1-7"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-8" tabindex="-1"></a><span class="co"># Read lines from file to a vector</span></span>
<span id="cb1-9"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-9" tabindex="-1"></a>fasta_lines <span class="ot">&lt;-</span> <span class="fu">readLines</span>(fasta_file)</span>
<span id="cb1-10"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-11" tabindex="-1"></a><span class="co"># Define an empty vector to hold the sequences in the file</span></span>
<span id="cb1-12"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-12" tabindex="-1"></a>sequences <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb1-13"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-14" tabindex="-1"></a><span class="co"># Loop over every line in fasta_lines vector</span></span>
<span id="cb1-15"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-15" tabindex="-1"></a><span class="cf">for</span> (line <span class="cf">in</span> fasta_lines) {</span>
<span id="cb1-16"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-16" tabindex="-1"></a>  <span class="co"># Logic to ignore any line that starts with a &quot;&gt;&quot; character</span></span>
<span id="cb1-17"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-17" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">startsWith</span>(line, <span class="st">&quot;&gt;&quot;</span>)) {</span>
<span id="cb1-18"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-18" tabindex="-1"></a>    <span class="co"># If line doesn&#39;t start with &quot;&gt;&quot; then add it as an item to sequences vector</span></span>
<span id="cb1-19"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-19" tabindex="-1"></a>    sequences <span class="ot">&lt;-</span> <span class="fu">c</span>(sequences, line)</span>
<span id="cb1-20"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-20" tabindex="-1"></a>  }</span>
<span id="cb1-21"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-21" tabindex="-1"></a>}</span>
<span id="cb1-22"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-22" tabindex="-1"></a></span>
<span id="cb1-23"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-23" tabindex="-1"></a><span class="co"># Inspect your sequences vector</span></span>
<span id="cb1-24"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-24" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Number of sequences in file: &quot;</span>, <span class="fu">length</span>(sequences), </span>
<span id="cb1-25"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb1-25" tabindex="-1"></a>             <span class="st">&quot;; First sequence: &quot;</span>, sequences[<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] &quot;Number of sequences in file: 100; First sequence: TGGGATAAAAACGAACGACTCGAGTCAAACGACAACAGTTATAAAGCACCCTCGGGTCTACTGATACTTCTGCTTGTTGCTACCAAATCCCAACTTTGCGTAAAGATAGACTCTGCTACTACGAACGTGGGTTTTGTACAGTGTGCCAGAGACCTCAGGTAAGGCCAGTAACTGTGTGTGCCATAAGGGGGCTTCTAAGAACTACACCTGCGCGTTAACGGTATCATATTGCCTGACAAGACACTCAATCTACACCAACGAGGGGTAACTGATCAACGAATTTGTCTCGCGTATCGGGAGAGCATCCACCCCTATGGGCGAATAACTAGATAGAGATCCTCAGAAACCGTTCCATCCCACTAACGGACAACCGATCACGGATATCTAATGGGCGGATACCCTGGACTTCCCCTGTATGACGGTCTGGAGTCAGAGTGAAGCCGGGCGCTTGAGTTTCTCAGGTTGCTCGGGTATTGATGTCCGGGCCACAAGCACGTATAATGGAGTGATCGTGCTGTTCTCGCAACTACCAAACTTGATTTACTTCAGGAGTCTAACGATACCTCGCAGTCACTGGTATCAATGCTCCGTCTAAAACAGTCGTTTTCAACCCGAACGATAATCATATAGCGGACCTTCGCAGGTGTCCGACACCTTTATGAAGGGGTCTGCGACGGAATCTGGGACACTTGGAGTGCATCGAACGCATGATCATTCCAACAACCTTGCAGGCGGTGAGCCGGCCCGGGCATATCAGGTCAAGCTTTGCGCGATTGAAATAGCGCAGAAATCCACTATGGATGTTACCTCGATTCACCTTTTCCATGACCCATATTCCCATGAGGGTGGAGGCAAACCTGGACATCATAGCCCCACGGTTAGAGACCTGCTACCATAAATGATCTTCGAACGATCCTCTAAGAGGCCATTGAACCTATCAACTTCGCAGAGTAGTGCGGGCTTTCTGGTGCAAGCTTAACTCAGTCTTATTGGTAATAAT&quot;</code></pre>
<p>Let’s break this code down in detail:</p>
<p><strong>1. Specify the File Name</strong>
The script begins with <code>fasta_file &lt;- "genomic_data_100.fasta"</code>.</p>
<ul>
<li>This step defines the name of the file we want to work with. The variable <code>fasta_file</code> acts as a placeholder for the file name, so if the file name changes later, we only need to update it here.</li>
<li>Keeping the file name as a variable makes the script more flexible and reusable.</li>
</ul>
<p><strong>2. Read the File into Memory</strong></p>
<p>The line <code>fasta_lines &lt;- readLines(fasta_file)</code> reads the contents of the FASTA file into a vector called <code>fasta_lines</code>.</p>
<ul>
<li>The function <code>readLines()</code> reads each line of the file as a separate element in the vector. For example, the vector might look like this:
<ul>
<li>“&gt;sequence_1”</li>
<li>“ATGCGTACGTA”</li>
<li>“&gt;sequence_2”</li>
<li>“GCTAGCTAGCT”
This raw input includes both header lines (starting with <code>&gt;</code>) and sequence lines. At this point, nothing has been filtered yet.</li>
</ul></li>
</ul>
<p><strong>3. Create a Place to Store Sequences</strong>
Next, we initialise an empty vector with <code>sequences &lt;- c()</code>.</p>
<ul>
<li>This step prepares a container to store the biological sequences. Since we only want the actual genetic data (not the headers), we need this separate vector.</li>
<li>Starting with an empty vector ensures that we don’t accidentally mix in data from other parts of the script.</li>
</ul>
<p><strong>4. Process Each Line in the File</strong>
Now comes the heart of the script: a loop that processes every line of the file one by one. The loop starts with <code>for (line in fasta_lines)</code>.</p>
<ul>
<li><strong>What does this mean?</strong>
<ul>
<li>The for loop iterates through each element in <code>fasta_lines</code>.</li>
<li>During each iteration, the current line is stored in the variable line.</li>
</ul></li>
<li>For example, on the first iteration, <code>line</code> might be <code>"&gt;sequence_1"</code>. On the second iteration, it might be <code>"ATGCGTACGTA"</code>, and so on.</li>
</ul>
<p><strong>5. Use an if Statement to Filter Lines</strong></p>
<p>Inside the loop, the script uses if <code>(!startsWith(line, "&gt;"))</code> to decide whether to process the current line.</p>
<ul>
<li>The function <code>startsWith(line, "&gt;")</code> checks if the line begins with the <code>&gt;</code> character (indicating a header). If it does, the <code>if</code> condition evaluates to <code>FALSE</code>, and the line is ignored.</li>
<li>The <code>!</code> symbol means “not.” So <code>!startsWith(line, "&gt;")</code> evaluates to <code>TRUE</code> if the line does not start with <code>&gt;</code>. These are the sequence lines we want.</li>
</ul>
<p><strong>6. Add Sequences to the Vector</strong>
When the condition is <code>TRUE</code> (i.e., the line is a sequence, not a header), the line is added to the sequences vector using <code>sequences &lt;- c(sequences, line)</code>.</p>
<ul>
<li>The <code>c()</code> function combines the existing <code>sequences</code> vector with the new line, effectively appending the sequence.</li>
<li>This ensures that all sequence lines are collected in one place.</li>
</ul>
<p><strong>7. What’s With the Curly Brackets {}?</strong>
In the script, the block of code inside the loop and the if statement is enclosed in curly brackets <code>{}</code>. For example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb3-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">startsWith</span>(line, <span class="st">&quot;&gt;&quot;</span>)) {</span>
<span id="cb3-2"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb3-2" tabindex="-1"></a>  sequences <span class="ot">&lt;-</span> <span class="fu">c</span>(sequences, line)</span>
<span id="cb3-3"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb3-3" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li><strong>What do the curly brackets do?</strong>
<ul>
<li>They group the code together, indicating what should run when the <code>if</code> condition is <code>TRUE</code>. Without curly brackets, only the first line after if would execute, which can lead to errors in more complex scripts.</li>
</ul></li>
<li><strong>Why are they needed here?</strong>
<ul>
<li>Since we’re using both a condition (<code>if</code>) and a loop (<code>for</code>), the brackets ensure the script knows which pieces of code belong together and when they should run.</li>
</ul></li>
<li><strong>Do I need to indent my code inside the curly brackets?</strong>
<ul>
<li>While indentation is not strictly required for the code to run, <strong>it is highly recommended</strong>. Indentation helps improve readability, making it clear what code belongs inside the curly brackets. Proper indentation makes it easier for others (and for you) to understand the logic and flow of the script, especially as your code grows more complex. In some languages, e.g. Python, indentation and the use of white space is not optional!</li>
</ul></li>
</ul>
<p><strong>8. Check the Results</strong>
The script ends with a single line to check the results:
<code>print(paste0("Number of sequences in file: ", length(sequences), "; First sequence: ", sequences[1]))</code></p>
<ul>
<li><strong>What does this do?</strong>
<ul>
<li><code>length(sequences)</code> counts the total number of sequences extracted.</li>
<li><code>sequences[1]</code> retrieves the first sequence.</li>
<li>The <code>paste0()</code> function combines these values into a single message for output.
For example, the output might be:</li>
</ul></li>
</ul>
<p><strong>Why is This Script Useful?</strong>
The script above serves as a foundational tool for working with FASTA files in R, efficiently extracting sequence data while ignoring headers. Using a <strong>loop</strong>, **conditional statement*, and <strong>vectors</strong> ensures it can scale to larger datasets. The final output provides a quick summary for easy verification.</p>
<p>The script also sets the stage for creating reusable tools in bioinformatics workflows. By wrapping this functionality into a function, we can streamline tasks and improve efficiency.</p>
</div>
<div id="writing-functional-code" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Writing Functional Code<a href="loops-ifs-and-functions-diving-deeper-into-r.html#writing-functional-code" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In programming, a function is a reusable block of code that performs a specific task. Functions take inputs, process them, and return outputs. Using functions helps avoid repetitive code, making your scripts more modular and easier to maintain.</p>
<p>For example, in previous sections, we’ve used functions like <code>print()</code> to display output. The <code>print()</code> function takes an argument (the thing you want to display) and prints it to the console. Functions can be as simple as this or as complex as needed, depending on the task.</p>
<p>Now, let’s explore how to write our own functions by transforming the code we’ve been working with into a reusable function. Remove all the code in your esiting “fasta-tools.R” file, then cut and paste the following code.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-1" tabindex="-1"></a><span class="co"># FILE: fasta-tools.R</span></span>
<span id="cb4-2"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-3" tabindex="-1"></a><span class="co"># Define a FUNCTION to extract all sequences from ANY FASTA file</span></span>
<span id="cb4-4"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-4" tabindex="-1"></a>extract_sequences_from_fasta <span class="ot">&lt;-</span> <span class="cf">function</span>(fasta_file) {</span>
<span id="cb4-5"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-6" tabindex="-1"></a>  <span class="co"># Read lines from file to a vector</span></span>
<span id="cb4-7"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-7" tabindex="-1"></a>  fasta_lines <span class="ot">&lt;-</span> <span class="fu">readLines</span>(fasta_file)</span>
<span id="cb4-8"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-8" tabindex="-1"></a>  </span>
<span id="cb4-9"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-9" tabindex="-1"></a>  <span class="co"># Define an empty vector to hold the sequences in the file</span></span>
<span id="cb4-10"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-10" tabindex="-1"></a>  sequences <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb4-11"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-11" tabindex="-1"></a>  </span>
<span id="cb4-12"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-12" tabindex="-1"></a>  <span class="co"># Loop over every line in fasta_lines vector</span></span>
<span id="cb4-13"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-13" tabindex="-1"></a>  <span class="cf">for</span> (line <span class="cf">in</span> fasta_lines) {</span>
<span id="cb4-14"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-14" tabindex="-1"></a>    <span class="co"># Logic to ignore any line that starts with a &quot;&gt;&quot; character</span></span>
<span id="cb4-15"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-15" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">startsWith</span>(line, <span class="st">&quot;&gt;&quot;</span>)) {</span>
<span id="cb4-16"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-16" tabindex="-1"></a>      <span class="co"># If line doesn&#39;t start with &quot;&gt;&quot; then add it as an item to sequences vector</span></span>
<span id="cb4-17"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-17" tabindex="-1"></a>      sequences <span class="ot">&lt;-</span> <span class="fu">c</span>(sequences, line)</span>
<span id="cb4-18"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-18" tabindex="-1"></a>    }</span>
<span id="cb4-19"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-19" tabindex="-1"></a>  }</span>
<span id="cb4-20"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-20" tabindex="-1"></a>  </span>
<span id="cb4-21"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-21" tabindex="-1"></a>  <span class="fu">return</span>(sequences)</span>
<span id="cb4-22"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb4-22" tabindex="-1"></a>}</span></code></pre></div>
<p>Try running the code above by clicking the “source” button in the top-right of your script window. What happens? Anything?</p>
<p>You’ll probably see some blue text in your console output, but you should see any outputs in black. That’s because right now, you’re script isn’t actually doing anything. All you’re doing by running the script is storing the function into your computer’s memory fo use later. You should see the function <code>extract_sequences_from_data()</code> appear in a section calld <strong>Functions</strong> in your environment window in the top-right of R Studio.</p>
<p>Here’s what we’ve done to <strong>“functionify”</strong> the code:</p>
<ol style="list-style-type: decimal">
<li><strong>Encapsulation of Logic into a Function</strong>
The main change is that we’ve wrapped the entire process inside a function definition:</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb5-1" tabindex="-1"></a>extract_sequences_from_fasta <span class="ot">&lt;-</span> <span class="cf">function</span>(fasta_file) { ... }</span></code></pre></div>
<p>This function now acts as a standalone unit, which can be used whenever we need to extract sequences from a FASTA file, with the <code>fasta_file</code> parameter acting as an input to specify which file to read.</p>
<p><strong>2. Parameterisation</strong>
In the original script, the file path was hardcoded directly into the code (<code>fasta_file &lt;- "genomic_data_100.fasta"</code>). In the function, we’ve replaced this with a parameter:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb6-1" tabindex="-1"></a><span class="cf">function</span>(fasta_file)</span></code></pre></div>
<p>This allows us to pass in any file path when calling the function, making it much more flexible. Instead of being tied to a specific file, the function now works for any FASTA file. How cool is that?</p>
<p><strong>3. Returning the Result</strong>
In the original code, the sequences were processed and printed directly within the script. In the function version, we use the <code>return(sequences)</code> statement at the end of the function to output the extracted sequences. This allows the function to be used in any context where we want to capture the output, such as storing it in a variable or processing it further.</p>
<h3>
So I’ve Functionified Mycode. Now What?
</h3>
<p>In the example below, we’ll use the <code>extract_sequences_from_fasta()</code> function that we’ve just defined in our <code>fasta-tools.R</code> script file in a new script called <code>main.R</code>. Create a new script called <code>main.R</code> and copy and paste the following block of code into it. Both <code>fasta-tools.R</code> and <code>main.R</code> scripts must sit next to each other in your project directory.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb7-1" tabindex="-1"></a><span class="co"># FILE: main.R</span></span>
<span id="cb7-2"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb7-3" tabindex="-1"></a><span class="co"># Import your fasta-tools.R file</span></span>
<span id="cb7-4"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb7-4" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;fasta-tools.R&quot;</span>)</span>
<span id="cb7-5"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb7-6" tabindex="-1"></a><span class="co"># Use the extract_sequences_from_data function that you have defined in your fasta-tools.R file</span></span>
<span id="cb7-7"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb7-7" tabindex="-1"></a>sequences <span class="ot">&lt;-</span> <span class="fu">extract_sequences_from_fasta</span>(<span class="st">&quot;genomic_data_100.fasta&quot;</span>)</span>
<span id="cb7-8"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb7-8" tabindex="-1"></a>  </span>
<span id="cb7-9"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb7-9" tabindex="-1"></a><span class="co"># Inspect your sequences vector</span></span>
<span id="cb7-10"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb7-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Number of sequences in file: &quot;</span>, <span class="fu">length</span>(sequences)))</span></code></pre></div>
<pre><code>## [1] &quot;Number of sequences in file: 100&quot;</code></pre>
<p><strong>What’s Happening Here?</strong>
- <strong>Source Your Function</strong>: By using <code>source("fasta-tools.R")</code>, we bring in the <code>extract_sequences_from_fasta()</code> function into the current script. <strong>This makes the function available for use without having to redefine it</strong>.</p>
<ul>
<li><p><strong>Calling the Function:</strong> The function is called with <code>extract_sequences_from_fasta("genomic_data_100.fasta")</code>. We pass in the FASTA file name, and the function does all the work of extracting the sequences. We then move on to inspect and analyse the results.</p></li>
<li><p><strong>Keeping It Clean</strong>: The <code>main.R</code> script remains clean and uncluttered, focusing on high-level tasks like extracting and analysing the sequences. The function handles the details of working with the FASTA file.</p></li>
</ul>
<h3>
<strong>Why Is This Useful?</strong>
</h3>
<ul>
<li><p><strong>Reusability</strong>: We can reuse the <code>extract_sequences_from_fasta</code> function in any future script. Instead of repeating the code for sequence extraction each time, we simply call the function and pass in the file name. This reduces redundancy and saves time.</p></li>
<li><p><strong>Clarity and Maintainability</strong>: By placing the logic for sequence extraction in its own file and function, the main script (<code>main.R</code>) is easier to read and understand. If something goes wrong with the sequence extraction, we’ll know exactly where to look—inside <code>fasta-tools.R</code> based on the error message that is output to our console.</p></li>
<li><p><strong>Scalability</strong>: As your projects grow, you’ll often need to extract sequences from different FASTA files or perform additional processing. With functions, it’s easy to add new functionality without cluttering your main scripts.</p></li>
</ul>
</div>
<div id="counting-motifs" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Counting Motifs<a href="loops-ifs-and-functions-diving-deeper-into-r.html#counting-motifs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-1" tabindex="-1"></a><span class="co"># FILE: fasta-tools.R</span></span>
<span id="cb9-2"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-3" tabindex="-1"></a><span class="co"># Extend the file above with the following ...</span></span>
<span id="cb9-4"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-5" tabindex="-1"></a><span class="co"># Define a function that can count the number of times a motif appears in a sequence</span></span>
<span id="cb9-6"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-6" tabindex="-1"></a>count_motif <span class="ot">&lt;-</span> <span class="cf">function</span>(sequence, <span class="at">motif=</span><span class="st">&quot;AAA&quot;</span>) {</span>
<span id="cb9-7"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-7" tabindex="-1"></a>  </span>
<span id="cb9-8"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-8" tabindex="-1"></a>  <span class="co"># Set counter to zero</span></span>
<span id="cb9-9"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-9" tabindex="-1"></a>  count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-10"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-10" tabindex="-1"></a>  </span>
<span id="cb9-11"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-11" tabindex="-1"></a>  <span class="co"># Loop through sequence character by character</span></span>
<span id="cb9-12"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nchar</span>(sequence), <span class="at">by=</span><span class="fu">nchar</span>(motif))) {</span>
<span id="cb9-13"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-13" tabindex="-1"></a>    </span>
<span id="cb9-14"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-14" tabindex="-1"></a>    <span class="co"># Slice your sequence to create a substring that is the same size as your motif</span></span>
<span id="cb9-15"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-15" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">substr</span>(sequence, i, i<span class="sc">+</span><span class="fu">nchar</span>(motif)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-16"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-16" tabindex="-1"></a>    </span>
<span id="cb9-17"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-17" tabindex="-1"></a>    <span class="co"># if your chunk and motif are the same add 1 to the count</span></span>
<span id="cb9-18"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-18" tabindex="-1"></a>    <span class="cf">if</span> (motif <span class="sc">==</span> chunk) {</span>
<span id="cb9-19"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-19" tabindex="-1"></a>      count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb9-20"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-20" tabindex="-1"></a>    }</span>
<span id="cb9-21"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-21" tabindex="-1"></a>    </span>
<span id="cb9-22"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-22" tabindex="-1"></a>  }</span>
<span id="cb9-23"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-23" tabindex="-1"></a>  </span>
<span id="cb9-24"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-24" tabindex="-1"></a>  <span class="fu">return</span>(count)</span>
<span id="cb9-25"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-25" tabindex="-1"></a>  </span>
<span id="cb9-26"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb9-26" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb10-1" tabindex="-1"></a><span class="co"># FILE: main.R</span></span>
<span id="cb10-2"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb10-3" tabindex="-1"></a><span class="co"># Extend the file above with the following ...</span></span>
<span id="cb10-4"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb10-5" tabindex="-1"></a><span class="co"># Count the number of times &quot;ACG&quot; occurs in the first sequence</span></span>
<span id="cb10-6"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb10-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Number of times &#39;ACG&#39; occurs in the first sequence: &quot;</span>, <span class="fu">count_motif</span>(sequences[<span class="dv">1</span>], <span class="st">&quot;ACG&quot;</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Number of times &#39;ACG&#39; occurs in the first sequence: 3&quot;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-1" tabindex="-1"></a><span class="co"># FILE: fasta-tools.R</span></span>
<span id="cb12-2"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-3" tabindex="-1"></a><span class="co"># Extend the file above with the following ...</span></span>
<span id="cb12-4"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-5" tabindex="-1"></a><span class="co"># Define a function to calculate mean frequency that a motif occurs in a vector of sequences:</span></span>
<span id="cb12-6"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-6" tabindex="-1"></a>calculate_mean_motif_freq <span class="ot">&lt;-</span> <span class="cf">function</span>(sequences, <span class="at">motif =</span> <span class="st">&quot;AAA&quot;</span>) {</span>
<span id="cb12-7"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-7" tabindex="-1"></a>  </span>
<span id="cb12-8"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-8" tabindex="-1"></a>  <span class="co"># create an empty vector to store motif frequencies</span></span>
<span id="cb12-9"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-9" tabindex="-1"></a>  motif_frequency <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb12-10"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-10" tabindex="-1"></a>  </span>
<span id="cb12-11"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-11" tabindex="-1"></a>  <span class="co"># Loop over sequences and use count function</span></span>
<span id="cb12-12"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-12" tabindex="-1"></a>  <span class="cf">for</span> (sequence <span class="cf">in</span> sequences) {</span>
<span id="cb12-13"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-13" tabindex="-1"></a>    count <span class="ot">&lt;-</span> <span class="fu">count_motif</span>(sequence, motif)</span>
<span id="cb12-14"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-14" tabindex="-1"></a>    motif_frequency <span class="ot">&lt;-</span> <span class="fu">c</span>(motif_frequency, count)</span>
<span id="cb12-15"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-15" tabindex="-1"></a>  }</span>
<span id="cb12-16"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-16" tabindex="-1"></a>  </span>
<span id="cb12-17"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-17" tabindex="-1"></a>  <span class="co"># Return a single float value containing the mean motif frequency</span></span>
<span id="cb12-18"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-18" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">mean</span>(motif_frequency))</span>
<span id="cb12-19"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb12-19" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb13-1" tabindex="-1"></a><span class="co"># FILE: main.R</span></span>
<span id="cb13-2"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb13-3" tabindex="-1"></a><span class="co"># Extend the file above with the following ...</span></span>
<span id="cb13-4"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb13-5" tabindex="-1"></a><span class="co"># Print the mean occurrence of &quot;ACG&quot; in all sequences</span></span>
<span id="cb13-6"><a href="loops-ifs-and-functions-diving-deeper-into-r.html#cb13-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Number of times &#39;ACG&#39; occurs in the first sequence: &quot;</span>, <span class="fu">calculate_mean_motif_freq</span>(sequences, <span class="st">&quot;ACG&quot;</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Number of times &#39;ACG&#39; occurs in the first sequence: 5.18&quot;</code></pre>
</div>
<div id="section" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> </h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistics-in-r-part-ii.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
